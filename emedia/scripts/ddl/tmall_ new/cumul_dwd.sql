

DROP TABLE IF EXISTS `dwd`.`ylmf_crowd_cumul_daily`;
CREATE TABLE `dwd`.`ylmf_crowd_cumul_daily` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `sub_crowd_value` BIGINT,
  `target_name` STRING,
  `target_type` INT,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_crowd_cumul_daily';



DROP TABLE IF EXISTS `dwd`.`ylmf_crowd_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_crowd_cumul_daily_mapping_fail` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `sub_crowd_value` BIGINT,
  `target_name` STRING,
  `target_type` INT,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_crowd_cumul_daily_mapping_fail';


DROP TABLE IF EXISTS `dwd`.`ylmf_crowd_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_crowd_cumul_daily_mapping_success` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `sub_crowd_value` BIGINT,
  `target_name` STRING,
  `target_type` INT,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_crowd_cumul_daily_mapping_success';




DROP TABLE IF EXISTS `dwd`.`ylmf_promotion_entity_cumul_daily`;
CREATE TABLE `dwd`.`ylmf_promotion_entity_cumul_daily` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_promotion_entity_cumul_daily';




DROP TABLE IF EXISTS `dwd`.`ylmf_promotion_entity_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_promotion_entity_cumul_daily_mapping_fail` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_promotion_entity_cumul_daily_mapping_fail';




DROP TABLE IF EXISTS `dwd`.`ylmf_promotion_entity_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_promotion_entity_cumul_daily_mapping_success` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_promotion_entity_cumul_daily_mapping_success';



DROP TABLE IF EXISTS `dwd`.`ylmf_adzone_cumul_daily`;
CREATE TABLE `dwd`.`ylmf_adzone_cumul_daily` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `adzone_id` BIGINT,
  `adzone_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_adzone_cumul_daily';




DROP TABLE IF EXISTS `dwd`.`ylmf_adzone_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_adzone_cumul_daily_mapping_fail` (
  `ad_date` STRING,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `adzone_id` BIGINT,
  `adzone_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_adzone_cumul_daily_mapping_fail';







DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_cumul_daily`;
CREATE TABLE `dwd`.`ylmf_campaign_cumul_daily` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` STRING,
  `alipay_inshop_num` STRING,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` STRING,
  `charge` STRING,
  `click` STRING,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` STRING,
  `icvr` STRING,
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_cumul_daily';




DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_campaign_cumul_daily_mapping_fail` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` STRING,
  `alipay_inshop_num` STRING,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` STRING,
  `charge` STRING,
  `click` STRING,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` STRING,
  `icvr` STRING,
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_cumul_daily_mapping_fail';


DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_campaign_cumul_daily_mapping_success` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` STRING,
  `alipay_inshop_num` STRING,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` STRING,
  `charge` STRING,
  `click` STRING,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` STRING,
  `icvr` STRING,
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_cumul_daily_mapping_success';



DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_group_cumul_daily`;
CREATE TABLE `dwd`.`ylmf_campaign_group_cumul_daily` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_group_cumul_daily';





DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_group_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_campaign_group_cumul_daily_mapping_fail` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_group_cumul_daily_mapping_fail';



DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_group_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_campaign_group_cumul_daily_mapping_success` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_group_cumul_daily_mapping_success';



DROP TABLE IF EXISTS `dwd`.`ylmf_creative_package_cumul_daily`;
CREATE TABLE `dwd`.`ylmf_creative_package_cumul_daily` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `creative_package_id` BIGINT,
  `creative_package_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_creative_package_cumul_daily';



DROP TABLE IF EXISTS `dwd`.`ylmf_creative_package_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_creative_package_cumul_daily_mapping_success` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `creative_package_id` BIGINT,
  `creative_package_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_creative_package_cumul_daily_mapping_success';





DROP TABLE IF EXISTS `dwd`.`ylmf_creative_package_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_creative_package_cumul_daily_mapping_fail` (
  `ad_date` DATE,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `creative_package_id` BIGINT,
  `creative_package_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_creative_package_cumul_daily_mapping_fail';








DROP TABLE IF EXISTS `dwd`.`ylmf_adzone_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_adzone_cumul_daily_mapping_success` (
  `ad_date` STRING,
  `campaign_group_id` INT,
  `campaign_group_name` STRING,
  `campaign_id` BIGINT,
  `campaign_name` STRING,
  `adzone_id` BIGINT,
  `adzone_name` STRING,
  `promotion_entity_id` BIGINT,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,5),
  `add_new_uv` STRING,
  `add_new_uv_cost` DECIMAL(20,5),
  `add_new_uv_rate` DECIMAL(20,5),
  `alipay_inshop_amt` DECIMAL(20,5),
  `alipay_inshop_num` STRING,
  `avg_access_page_num` DECIMAL(20,5),
  `avg_deep_access_times` DECIMAL(20,5),
  `cart_num` STRING,
  `charge` DECIMAL(20,5),
  `click` STRING,
  `cpc` DECIMAL(20,5),
  `cpm` DECIMAL(20,5),
  `ctr` DECIMAL(20,5),
  `cvr` DECIMAL(20,5),
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` DECIMAL(20,5),
  `gmv_inshop_num` STRING,
  `icvr` DECIMAL(20,5),
  `impression` STRING,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` DECIMAL(20,5),
  `inshop_pv` STRING,
  `inshop_pv_rate` DECIMAL(20,5),
  `inshop_uv` STRING,
  `prepay_inshop_amt` DECIMAL(20,5),
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` DECIMAL(20,5),
  `roi` DECIMAL(20,5),
  `search_click_cnt` STRING,
  `search_click_cost` DECIMAL(20,5),
  `biz_code` STRING,
  `offset` INT,
  `page_size` INT,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` BOOLEAN,
  `group_by_log_date` BOOLEAN,
  `group_by_promotion_entity_id` BOOLEAN,
  `start_time` STRING,
  `end_time` STRING,
  `effect_type` STRING,
  `effect` INT,
  `effect_days` INT,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` BIGINT,
  `dw_batch_number` BIGINT,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_adzone_cumul_daily_mapping_success';



DROP TABLE IF EXISTS `dwd`.`ztc_adgroup_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ztc_adgroup_cumul_daily_mapping_fail` (
  `ad_date` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `total_cart_quantity` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` DOUBLE,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_order_value` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_order_quantity` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `img_url` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_order_value` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_order_quantity` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `thedate` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_adgroup_cumul_daily_mapping_fail';




DROP TABLE IF EXISTS `dwd`.`ztc_adgroup_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ztc_adgroup_cumul_daily_mapping_success` (
  `ad_date` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `total_cart_quantity` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` DOUBLE,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_order_value` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_order_quantity` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `img_url` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_order_value` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_order_quantity` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `thedate` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_adgroup_cumul_daily_mapping_success';




DROP TABLE IF EXISTS `dwd`.`ztc_adgroup_cumul_daily`;
CREATE TABLE `dwd`.`ztc_adgroup_cumul_daily` (
  `ad_date` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `total_cart_quantity` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` DOUBLE,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_order_value` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_order_quantity` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `img_url` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_order_value` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_order_quantity` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `thedate` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `effect` INT,
  `ad_format_lv2` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `campaign_subtype` STRING,
  `campaign_type` STRING,
  `mdm_productline_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_adgroup_cumul_daily';



DROP TABLE IF EXISTS `dwd`.`ztc_campaign_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ztc_campaign_cumul_daily_mapping_success` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type` STRING,
  `campaign_type_name` STRING,
  `cart_total` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` DOUBLE,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_transaction` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_transaction_shipping` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_transaction` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_transaction_shipping` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_campaign_cumul_daily_mapping_success';





DROP TABLE IF EXISTS `dwd`.`ztc_campaign_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ztc_campaign_cumul_daily_mapping_fail` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type` STRING,
  `campaign_type_name` STRING,
  `cart_total` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` DOUBLE,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_transaction` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_transaction_shipping` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_transaction` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_transaction_shipping` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_campaign_cumul_daily_mapping_fail';




DROP TABLE IF EXISTS `dwd`.`ztc_campaign_cumul_daily`;
CREATE TABLE `dwd`.`ztc_campaign_cumul_daily` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `cart_total` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` DOUBLE,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_transaction` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_transaction_shipping` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_transaction` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_transaction_shipping` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `ad_format_lv2` STRING,
  `effect` INT,
  `campaign_subtype` STRING,
  `campaign_type` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `adgroup_name` STRING,
  `adgroup_id` STRING,
  `mdm_productline_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_campaign_cumul_daily';














DROP TABLE IF EXISTS `dwd`.`ztc_creative_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ztc_creative_cumul_daily_mapping_success` (
  `ad_date` STRING,
  `adgroup_id` STRING,
  `adgroup_title` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `cart_total` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` STRING,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `creative_title` STRING,
  `creativeid` STRING,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_transaction` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_transaction_shipping` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `img_url` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_transaction` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_transaction_shipping` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_creative_cumul_daily_mapping_success';



DROP TABLE IF EXISTS `dwd`.`ztc_creative_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ztc_creative_cumul_daily_mapping_fail` (
  `ad_date` STRING,
  `adgroup_id` STRING,
  `adgroup_title` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `cart_total` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` STRING,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `creative_title` STRING,
  `creativeid` STRING,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_transaction` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_transaction_shipping` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `img_url` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_transaction` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_transaction_shipping` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_creative_cumul_daily_mapping_fail';




DROP TABLE IF EXISTS `dwd`.`ztc_creative_cumul_daily`;
CREATE TABLE `dwd`.`ztc_creative_cumul_daily` (
  `ad_date` STRING,
  `adgroup_id` STRING,
  `adgroup_title` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `cart_total` STRING,
  `cart_total_coverage` STRING,
  `click` STRING,
  `click_shopping_amt` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `click_shopping_num` STRING,
  `cost` DOUBLE,
  `cost_in_yuan` STRING,
  `coverage` DOUBLE,
  `cpc` DOUBLE,
  `cpc_in_yuan` DOUBLE,
  `cpm` DOUBLE,
  `cpm_in_yuan` DOUBLE,
  `creative_title` STRING,
  `creativeid` STRING,
  `ctr` DOUBLE,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `dir_epre_pay_cnt` STRING,
  `direct_cart_total` STRING,
  `direct_transaction` DOUBLE,
  `direct_transaction_in_yuan` STRING,
  `direct_transaction_shipping` STRING,
  `direct_transaction_shipping_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `epre_pay_cnt` STRING,
  `fav_item_total` STRING,
  `fav_item_total_coverage` STRING,
  `fav_shop_total` STRING,
  `fav_total` STRING,
  `hfh_dj_amt` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `hfh_ys_cnt` STRING,
  `img_url` STRING,
  `impression` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `indir_epre_pay_cnt` STRING,
  `indirect_cart_total` STRING,
  `indirect_transaction` DOUBLE,
  `indirect_transaction_in_yuan` STRING,
  `indirect_transaction_shipping` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `lz_cnt` STRING,
  `rh_cnt` STRING,
  `roi` DOUBLE,
  `search_impression` STRING,
  `search_transaction` STRING,
  `search_transaction_in_yuan` STRING,
  `transaction_shipping_total` STRING,
  `transaction_total` STRING,
  `transaction_total_in_yuan` STRING,
  `ww_cnt` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `ad_format_lv2` STRING,
  `effect` INT,
  `campaign_subtype` STRING,
  `campaign_type` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `adgroup_name` STRING,
  `mdm_productline_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_creative_cumul_daily';




DROP TABLE IF EXISTS `dwd`.`ztc_keyword_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ztc_keyword_cumul_daily_mapping_success` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type` STRING,
  `campaign_type_name` STRING,
  `adgroup_name` STRING,
  `adgroup_id` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `impression` STRING,
  `click` STRING,
  `cost` DOUBLE,
  `ctr` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `fav_total` STRING,
  `fav_item_total` STRING,
  `fav_shop_total` STRING,
  `total_cart_quantity` STRING,
  `direct_cart_total` STRING,
  `indirect_cart_total` STRING,
  `cart_total_cost` STRING,
  `fav_item_total_cost` STRING,
  `fav_item_total_coverage` STRING,
  `cart_total_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_cnt` STRING,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_cnt` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_cnt` STRING,
  `transaction_total` STRING,
  `direct_order_value` DOUBLE,
  `indirect_order_value` DOUBLE,
  `transaction_shipping_total` STRING,
  `direct_order_quantity` STRING,
  `indirect_order_quantity` STRING,
  `roi` DOUBLE,
  `coverage` DOUBLE,
  `direct_transaction_shipping_coverage` STRING,
  `click_shopping_num` STRING,
  `click_shopping_amt` STRING,
  `search_impression` STRING,
  `search_transaction` STRING,
  `ww_cnt` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_dj_amt` STRING,
  `hfh_ys_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `rh_cnt` STRING,
  `lz_cnt` STRING,
  `transaction_total_in_yuan` STRING,
  `cpm_in_yuan` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `cpc_in_yuan` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `cart_total_cost_in_yuan` STRING,
  `direct_transaction_in_yuan` STRING,
  `indirect_transaction_in_yuan` STRING,
  `fav_item_total_cost_in_yuan` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `cost_in_yuan` STRING,
  `search_transaction_in_yuan` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `img_url` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `wireless_price` STRING,
  `avg_rank` STRING,
  `pc_price` STRING,
  `keyword_name` STRING,
  `campaign_budget` STRING,
  `keyword_id` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_keyword_cumul_daily_mapping_success';




DROP TABLE IF EXISTS `dwd`.`ztc_keyword_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ztc_keyword_cumul_daily_mapping_fail` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type` STRING,
  `campaign_type_name` STRING,
  `adgroup_name` STRING,
  `adgroup_id` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `impression` STRING,
  `click` STRING,
  `cost` DOUBLE,
  `ctr` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `fav_total` STRING,
  `fav_item_total` STRING,
  `fav_shop_total` STRING,
  `total_cart_quantity` STRING,
  `direct_cart_total` STRING,
  `indirect_cart_total` STRING,
  `cart_total_cost` STRING,
  `fav_item_total_cost` STRING,
  `fav_item_total_coverage` STRING,
  `cart_total_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_cnt` STRING,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_cnt` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_cnt` STRING,
  `transaction_total` STRING,
  `direct_order_value` DOUBLE,
  `indirect_order_value` DOUBLE,
  `transaction_shipping_total` STRING,
  `direct_order_quantity` STRING,
  `indirect_order_quantity` STRING,
  `roi` DOUBLE,
  `coverage` DOUBLE,
  `direct_transaction_shipping_coverage` STRING,
  `click_shopping_num` STRING,
  `click_shopping_amt` STRING,
  `search_impression` STRING,
  `search_transaction` STRING,
  `ww_cnt` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_dj_amt` STRING,
  `hfh_ys_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `rh_cnt` STRING,
  `lz_cnt` STRING,
  `transaction_total_in_yuan` STRING,
  `cpm_in_yuan` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `cpc_in_yuan` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `cart_total_cost_in_yuan` STRING,
  `direct_transaction_in_yuan` STRING,
  `indirect_transaction_in_yuan` STRING,
  `fav_item_total_cost_in_yuan` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `cost_in_yuan` STRING,
  `search_transaction_in_yuan` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `img_url` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `wireless_price` STRING,
  `avg_rank` STRING,
  `pc_price` STRING,
  `keyword_name` STRING,
  `campaign_budget` STRING,
  `keyword_id` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_keyword_cumul_daily_mapping_fail';




DROP TABLE IF EXISTS `dwd`.`ztc_keyword_cumul_daily`;
CREATE TABLE `dwd`.`ztc_keyword_cumul_daily` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type_name` STRING,
  `adgroup_name` STRING,
  `adgroup_id` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `impression` STRING,
  `click` STRING,
  `cost` DOUBLE,
  `ctr` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `fav_total` STRING,
  `fav_item_total` STRING,
  `fav_shop_total` STRING,
  `total_cart_quantity` STRING,
  `direct_cart_total` STRING,
  `indirect_cart_total` STRING,
  `cart_total_cost` STRING,
  `fav_item_total_cost` STRING,
  `fav_item_total_coverage` STRING,
  `cart_total_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_cnt` STRING,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_cnt` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_cnt` STRING,
  `transaction_total` STRING,
  `direct_order_value` DOUBLE,
  `indirect_order_value` DOUBLE,
  `transaction_shipping_total` STRING,
  `direct_order_quantity` STRING,
  `indirect_order_quantity` STRING,
  `roi` DOUBLE,
  `coverage` DOUBLE,
  `direct_transaction_shipping_coverage` STRING,
  `click_shopping_num` STRING,
  `click_shopping_amt` STRING,
  `search_impression` STRING,
  `search_transaction` STRING,
  `ww_cnt` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_dj_amt` STRING,
  `hfh_ys_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `rh_cnt` STRING,
  `lz_cnt` STRING,
  `transaction_total_in_yuan` STRING,
  `cpm_in_yuan` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `cpc_in_yuan` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `cart_total_cost_in_yuan` STRING,
  `direct_transaction_in_yuan` STRING,
  `indirect_transaction_in_yuan` STRING,
  `fav_item_total_cost_in_yuan` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `cost_in_yuan` STRING,
  `search_transaction_in_yuan` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `img_url` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `wireless_price` STRING,
  `avg_rank` STRING,
  `pc_price` STRING,
  `keyword_name` STRING,
  `campaign_budget` STRING,
  `keyword_id` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `effect` INT,
  `ad_format_lv2` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `campaign_subtype` STRING,
  `campaign_type` STRING,
  `mdm_productline_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `niname` STRING,
  `keyword_type` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_keyword_cumul_daily';





DROP TABLE IF EXISTS `dwd`.`ztc_target_cumul_daily_mapping_success`;
CREATE TABLE `dwd`.`ztc_target_cumul_daily_mapping_success` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_type` STRING,
  `campaign_type_name` STRING,
  `crowd_id` STRING,
  `crowd_name` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `impression` STRING,
  `click` STRING,
  `cost` DOUBLE,
  `ctr` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `fav_total` STRING,
  `fav_item_total` STRING,
  `fav_shop_total` STRING,
  `cart_total` STRING,
  `direct_cart_total` STRING,
  `indirect_cart_total` STRING,
  `cart_total_cost` STRING,
  `fav_item_total_cost` STRING,
  `fav_item_total_coverage` STRING,
  `cart_total_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_cnt` STRING,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_cnt` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_cnt` STRING,
  `transaction_total` STRING,
  `direct_transaction` DOUBLE,
  `indirect_transaction` DOUBLE,
  `transaction_shipping_total` STRING,
  `direct_transaction_shipping` STRING,
  `indirect_transaction_shipping` STRING,
  `roi` DOUBLE,
  `coverage` DOUBLE,
  `direct_transaction_shipping_coverage` STRING,
  `click_shopping_num` STRING,
  `click_shopping_amt` STRING,
  `search_impression` STRING,
  `search_transaction` STRING,
  `ww_cnt` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_dj_amt` STRING,
  `hfh_ys_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `rh_cnt` STRING,
  `lz_cnt` STRING,
  `transaction_total_in_yuan` STRING,
  `cpm_in_yuan` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `cpc_in_yuan` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `cart_total_cost_in_yuan` STRING,
  `direct_transaction_in_yuan` STRING,
  `indirect_transaction_in_yuan` STRING,
  `fav_item_total_cost_in_yuan` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `cost_in_yuan` STRING,
  `search_transaction_in_yuan` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `img_url` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_target_cumul_daily_mapping_success';





DROP TABLE IF EXISTS `dwd`.`ztc_target_cumul_daily_mapping_fail`;
CREATE TABLE `dwd`.`ztc_target_cumul_daily_mapping_fail` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_type` STRING,
  `campaign_type_name` STRING,
  `crowd_id` STRING,
  `crowd_name` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `impression` STRING,
  `click` STRING,
  `cost` DOUBLE,
  `ctr` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `fav_total` STRING,
  `fav_item_total` STRING,
  `fav_shop_total` STRING,
  `cart_total` STRING,
  `direct_cart_total` STRING,
  `indirect_cart_total` STRING,
  `cart_total_cost` STRING,
  `fav_item_total_cost` STRING,
  `fav_item_total_coverage` STRING,
  `cart_total_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_cnt` STRING,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_cnt` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_cnt` STRING,
  `transaction_total` STRING,
  `direct_transaction` DOUBLE,
  `indirect_transaction` DOUBLE,
  `transaction_shipping_total` STRING,
  `direct_transaction_shipping` STRING,
  `indirect_transaction_shipping` STRING,
  `roi` DOUBLE,
  `coverage` DOUBLE,
  `direct_transaction_shipping_coverage` STRING,
  `click_shopping_num` STRING,
  `click_shopping_amt` STRING,
  `search_impression` STRING,
  `search_transaction` STRING,
  `ww_cnt` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_dj_amt` STRING,
  `hfh_ys_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `rh_cnt` STRING,
  `lz_cnt` STRING,
  `transaction_total_in_yuan` STRING,
  `cpm_in_yuan` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `cpc_in_yuan` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `cart_total_cost_in_yuan` STRING,
  `direct_transaction_in_yuan` STRING,
  `indirect_transaction_in_yuan` STRING,
  `fav_item_total_cost_in_yuan` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `cost_in_yuan` STRING,
  `search_transaction_in_yuan` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `img_url` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_target_cumul_daily_mapping_fail';





DROP TABLE IF EXISTS `dwd`.`ztc_target_cumul_daily`;
CREATE TABLE `dwd`.`ztc_target_cumul_daily` (
  `ad_date` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_type_name` STRING,
  `crowd_id` STRING,
  `crowd_name` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `pv_type_in` STRING,
  `impression` STRING,
  `click` STRING,
  `cost` DOUBLE,
  `ctr` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `fav_total` STRING,
  `fav_item_total` STRING,
  `fav_shop_total` STRING,
  `cart_total` STRING,
  `direct_cart_total` STRING,
  `indirect_cart_total` STRING,
  `cart_total_cost` STRING,
  `fav_item_total_cost` STRING,
  `fav_item_total_coverage` STRING,
  `cart_total_coverage` STRING,
  `epre_pay_amt` STRING,
  `epre_pay_cnt` STRING,
  `dir_epre_pay_amt` STRING,
  `dir_epre_pay_cnt` STRING,
  `indir_epre_pay_amt` STRING,
  `indir_epre_pay_cnt` STRING,
  `transaction_total` STRING,
  `direct_transaction` DOUBLE,
  `indirect_transaction` DOUBLE,
  `transaction_shipping_total` STRING,
  `direct_transaction_shipping` STRING,
  `indirect_transaction_shipping` STRING,
  `roi` DOUBLE,
  `coverage` DOUBLE,
  `direct_transaction_shipping_coverage` STRING,
  `click_shopping_num` STRING,
  `click_shopping_amt` STRING,
  `search_impression` STRING,
  `search_transaction` STRING,
  `ww_cnt` STRING,
  `hfh_dj_cnt` STRING,
  `hfh_dj_amt` STRING,
  `hfh_ys_cnt` STRING,
  `hfh_ys_amt` STRING,
  `hfh_ykj_cnt` STRING,
  `hfh_ykj_amt` STRING,
  `rh_cnt` STRING,
  `lz_cnt` STRING,
  `transaction_total_in_yuan` STRING,
  `cpm_in_yuan` STRING,
  `indir_epre_pay_amt_in_yuan` STRING,
  `cpc_in_yuan` STRING,
  `dir_epre_pay_amt_in_yuan` STRING,
  `click_shopping_amt_in_yuan` STRING,
  `hfh_ys_amt_in_yuan` STRING,
  `cart_total_cost_in_yuan` STRING,
  `direct_transaction_in_yuan` STRING,
  `indirect_transaction_in_yuan` STRING,
  `fav_item_total_cost_in_yuan` STRING,
  `epre_pay_amt_in_yuan` STRING,
  `hfh_ykj_amt_in_yuan` STRING,
  `cost_in_yuan` STRING,
  `search_transaction_in_yuan` STRING,
  `item_id` STRING,
  `linkurl` STRING,
  `img_url` STRING,
  `hfh_dj_amt_in_yuan` STRING,
  `req_start_time` STRING,
  `req_end_time` STRING,
  `req_offset` STRING,
  `req_page_size` STRING,
  `req_effect` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `ad_format_lv2` STRING,
  `effect` INT,
  `campaign_subtype` STRING,
  `campaign_type` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `mdm_productline_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ztc_target_cumul_daily';




DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_ztc_cumul_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_ztc_cumul_daily_fact` (
  `ad_date` STRING,
  `pv_type_in` STRING,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `effect` INT,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type` STRING,
  `campaign_subtype` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `item_id` STRING,
  `keyword_type` STRING,
  `niname` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `cost` DOUBLE,
  `click` INT,
  `impression` INT,
  `indirect_order_quantity` INT,
  `direct_order_quantity` INT,
  `indirect_order_value` DOUBLE,
  `direct_order_value` DOUBLE,
  `total_cart_quantity` INT,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (`report_level`)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_ztc_cumul_daily_fact';




DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_ylmf_cumul_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_ylmf_cumul_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `sub_crowd_name` STRING,
  `audience_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_amount` DECIMAL(20,4),
  `cart_quantity` BIGINT,
  `gmv_order_quantity` BIGINT,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (`report_level`)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_ylmf_cumul_daily_fact';
