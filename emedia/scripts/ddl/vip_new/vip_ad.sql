DROP TABLE IF EXISTS `stg`.`vip_otd_ad_daily_fact`;
CREATE TABLE IF NOT EXISTS `stg`.`vip_otd_ad_daily_fact` (
  date STRING,
  channel STRING,
  campaign_id STRING,
  campaign_title STRING,
  ad_id STRING,
  ad_title STRING,
  placement_id STRING,
  placement_title STRING,
  impression STRING,
  click STRING,
  cost STRING,
  click_rate STRING,
  cost_per_click STRING,
  cost_per_mille STRING,
  app_waken_pv STRING,
  cost_per_app_waken_uv STRING,
  app_waken_uv STRING,
  app_waken_rate STRING,
  miniapp_uv STRING,
  app_uv STRING,
  cost_per_app_uv STRING,
  cost_per_miniapp_uv STRING,
  general_uv STRING,
  product_uv STRING,
  special_uv STRING,
  book_customer_in_24hour STRING,
  new_customer_in_24hour STRING,
  customer_in_24hour STRING,
  book_sales_in_24hour STRING,
  sales_in_24hour STRING,
  book_orders_in_24hour STRING,
  orders_in_24hour STRING,
  book_roi_in_24hour STRING,
  roi_in_24hour STRING,
  book_customer_in_14day STRING,
  new_customer_in_14day STRING,
  customer_in_14day STRING,
  book_sales_in_14day STRING,
  sales_in_14day STRING,
  book_orders_in_14day STRING,
  orders_in_14day STRING,
  book_roi_in_14day STRING,
  roi_in_14day STRING,
  req_advertiser_id STRING,
  req_channel STRING,
  req_level STRING,
  req_start_date STRING,
  req_end_date STRING,
  dw_batch_number STRING,
  dw_create_time STRING,
  dw_resource STRING,
  effect STRING,
  data_source STRING,
  dw_batch_id STRING,
  dw_etl_date DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_stg.db/vip_otd_ad_daily_fact';


DROP TABLE IF EXISTS `ods`.`vip_otd_ad_daily_fact`;
CREATE TABLE IF NOT EXISTS `ods`.`vip_otd_ad_daily_fact` (
  ad_date DATE,
  req_advertiser_id STRING,
  channel STRING,
  campaign_id STRING,
  campaign_title STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  placement_id STRING,
  placement_title STRING,
  impression BIGINT,
  click BIGINT,
  cost DECIMAL(19,4),
  app_waken_uv BIGINT,
  cost_per_app_waken_uv BIGINT,
  app_waken_pv BIGINT,
  app_waken_rate DECIMAL(19,4),
  miniapp_uv BIGINT,
  app_uv BIGINT,
  click_rate DECIMAL(19,4),
  cost_per_click BIGINT,
  cost_per_mille BIGINT,
  cost_per_app_uv BIGINT,
  cost_per_miniapp_uv BIGINT,
  general_uv BIGINT,
  product_uv BIGINT,
  special_uv BIGINT,
  effect STRING,
  book_customer_in_24hour BIGINT,
  new_customer_in_24hour BIGINT,
  customer_in_24hour BIGINT,
  book_sales_in_24hour BIGINT,
  sales_in_24hour BIGINT,
  book_orders_in_24hour BIGINT,
  orders_in_24hour BIGINT,
  book_roi_in_24hour DECIMAL(19,4),
  roi_in_24hour DECIMAL(19,4),
  book_customer_in_14day BIGINT,
  new_customer_in_14day BIGINT,
  customer_in_14day BIGINT,
  book_sales_in_14day BIGINT,
  sales_in_14day BIGINT,
  book_orders_in_14day BIGINT,
  orders_in_14day BIGINT,
  book_roi_in_14day DECIMAL(19,4),
  roi_in_14day DECIMAL(19,4),
  req_channel STRING,
  req_level STRING,
  req_start_date DATE,
  req_end_date DATE,
  dw_batch_number STRING,
  dw_create_time TIMESTAMP,
  data_source STRING,
  dw_batch_id STRING,
  dw_etl_date DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_ods.db/vip_otd_ad_daily_fact';


DROP TABLE IF EXISTS `dwd`.`vip_otd_ad_daily_mapping_fail`;
CREATE TABLE IF NOT EXISTS `dwd`.`vip_otd_ad_daily_mapping_fail` (
  ad_date DATE,
  req_advertiser_id STRING,
  channel STRING,
  campaign_id STRING,
  campaign_title STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  placement_id STRING,
  placement_title STRING,
  impression BIGINT,
  click BIGINT,
  cost DECIMAL(19,4),
  app_waken_uv BIGINT,
  cost_per_app_waken_uv BIGINT,
  app_waken_pv BIGINT,
  app_waken_rate DECIMAL(19,4),
  miniapp_uv BIGINT,
  app_uv BIGINT,
  click_rate DECIMAL(19,4),
  cost_per_click BIGINT,
  cost_per_mille BIGINT,
  cost_per_app_uv BIGINT,
  cost_per_miniapp_uv BIGINT,
  general_uv BIGINT,
  product_uv BIGINT,
  special_uv BIGINT,
  effect STRING,
  book_customer_in_24hour BIGINT,
  new_customer_in_24hour BIGINT,
  customer_in_24hour BIGINT,
  book_sales_in_24hour BIGINT,
  sales_in_24hour BIGINT,
  book_orders_in_24hour BIGINT,
  orders_in_24hour BIGINT,
  book_roi_in_24hour DECIMAL(19,4),
  roi_in_24hour DECIMAL(19,4),
  book_customer_in_14day BIGINT,
  new_customer_in_14day BIGINT,
  customer_in_14day BIGINT,
  book_sales_in_14day BIGINT,
  sales_in_14day BIGINT,
  book_orders_in_14day BIGINT,
  orders_in_14day BIGINT,
  book_roi_in_14day DECIMAL(19,4),
  roi_in_14day DECIMAL(19,4),
  req_channel STRING,
  req_level STRING,
  req_start_date DATE,
  req_end_date DATE,
  dw_batch_number STRING,
  dw_create_time TIMESTAMP,
  data_source STRING,
  dw_batch_id STRING,
  category_id STRING,
  brand_id STRING,
  etl_date DATE,
  etl_create_time TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/vip_otd_ad_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`vip_otd_ad_daily_mapping_success`;
CREATE TABLE IF NOT EXISTS `dwd`.`vip_otd_ad_daily_mapping_success` (
  ad_date DATE,
  req_advertiser_id STRING,
  channel STRING,
  campaign_id STRING,
  campaign_title STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  placement_id STRING,
  placement_title STRING,
  impression BIGINT,
  click BIGINT,
  cost DECIMAL(19,4),
  app_waken_uv BIGINT,
  cost_per_app_waken_uv BIGINT,
  app_waken_pv BIGINT,
  app_waken_rate DECIMAL(19,4),
  miniapp_uv BIGINT,
  app_uv BIGINT,
  click_rate DECIMAL(19,4),
  cost_per_click BIGINT,
  cost_per_mille BIGINT,
  cost_per_app_uv BIGINT,
  cost_per_miniapp_uv BIGINT,
  general_uv BIGINT,
  product_uv BIGINT,
  special_uv BIGINT,
  effect STRING,
  book_customer_in_24hour BIGINT,
  new_customer_in_24hour BIGINT,
  customer_in_24hour BIGINT,
  book_sales_in_24hour BIGINT,
  sales_in_24hour BIGINT,
  book_orders_in_24hour BIGINT,
  orders_in_24hour BIGINT,
  book_roi_in_24hour DECIMAL(19,4),
  roi_in_24hour DECIMAL(19,4),
  book_customer_in_14day BIGINT,
  new_customer_in_14day BIGINT,
  customer_in_14day BIGINT,
  book_sales_in_14day BIGINT,
  sales_in_14day BIGINT,
  book_orders_in_14day BIGINT,
  orders_in_14day BIGINT,
  book_roi_in_14day DECIMAL(19,4),
  roi_in_14day DECIMAL(19,4),
  req_channel STRING,
  req_level STRING,
  req_start_date DATE,
  req_end_date DATE,
  dw_batch_number STRING,
  dw_create_time TIMESTAMP,
  data_source STRING,
  dw_batch_id STRING,
  category_id STRING,
  brand_id STRING,
  etl_date DATE,
  etl_create_time TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/vip_otd_ad_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_vip_otd_ad_daily_fact`;
CREATE TABLE IF NOT EXISTS `dwd`.`tb_media_emedia_vip_otd_ad_daily_fact` (
  ad_date DATE,
  store_id STRING,
  account_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  impression BIGINT,
  click BIGINT,
  cost DECIMAL(19,4),
  app_waken_uv BIGINT,
  cost_per_app_waken_uv BIGINT,
  app_waken_pv BIGINT,
  app_waken_rate DECIMAL(19,4),
  miniapp_uv BIGINT,
  app_uv BIGINT,
  cost_per_app_uv BIGINT,
  cost_per_miniapp_uv BIGINT,
  general_uv BIGINT,
  product_uv BIGINT,
  special_uv BIGINT,
  effect STRING,
  book_customer BIGINT,
  new_customer BIGINT,
  customer BIGINT,
  book_sales BIGINT,
  order_value BIGINT,
  book_orders BIGINT,
  order_quantity BIGINT,
  dw_create_time TIMESTAMP,
  dw_batch_number STRING,
  etl_source_table STRING,
  etl_update_time TIMESTAMP,
  etl_create_time TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_vip_otd_ad_daily_fact';

DROP TABLE IF EXISTS `ds`.`gm_media_emedia_vip_otd_ad_daily_fact`;
CREATE TABLE IF NOT EXISTS `ds`.`gm_media_emedia_vip_otd_ad_daily_fact` (
  ad_date DATE,
  store_id STRING,
  account_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  impression BIGINT,
  click BIGINT,
  cost DECIMAL(19,4),
  app_waken_uv BIGINT,
  cost_per_app_waken_uv BIGINT,
  app_waken_pv BIGINT,
  app_waken_rate DECIMAL(19,4),
  miniapp_uv BIGINT,
  app_uv BIGINT,
  cost_per_app_uv BIGINT,
  cost_per_miniapp_uv BIGINT,
  general_uv BIGINT,
  product_uv BIGINT,
  special_uv BIGINT,
  effect STRING,
  book_customer BIGINT,
  new_customer BIGINT,
  customer BIGINT,
  book_sales BIGINT,
  order_value BIGINT,
  book_orders BIGINT,
  order_quantity BIGINT,
  dw_create_time TIMESTAMP,
  dw_batch_number STRING,
  etl_source_table STRING,
  etl_update_time TIMESTAMP,
  etl_create_time TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_ds.db/gm_media_emedia_vip_otd_ad_daily_fact';
