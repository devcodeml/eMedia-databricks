DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_jdkc_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_jdkc_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_subtype` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `sku_id` STRING,
  `keyword_type` STRING,
  `niname` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `delivery_version` STRING,
  `delivery_type` STRING,
  `mobile_type` STRING,
  `source` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `put_type` STRING,
  `campaign_put_type` STRING,
  `targeting_type` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_value` DECIMAL(20,4),
  `total_cart_quantity` BIGINT,
  `new_customer_quantity` INT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_jdkc_daily_fact';


DROP TABLE IF EXISTS `dwd`.`jdkc_keyword_daily_old`;
CREATE TABLE dwd.jdkc_keyword_daily_old (
  ad_date TIMESTAMP,
  pin_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  keyword_name STRING,
  type STRING,
  req_isorderorclick STRING,
  req_clickororderday STRING,
  effect STRING,
  effect_days STRING,
  req_orderstatuscategory STRING,
  mobiletype STRING,
  clicks DECIMAL(19,4),
  cost DECIMAL(19,4),
  ctr STRING,
  cpm STRING,
  cpc STRING,
  totalorderroi STRING,
  impressions DECIMAL(19,4),
  order_quantity DECIMAL(19,4),
  order_value DECIMAL(19,4),
  indirect_order_quantity STRING,
  direct_order_quantity STRING,
  indirect_order_value STRING,
  direct_order_value STRING,
  indirectcartcnt STRING,
  directcartcnt STRING,
  total_cart_quantity DECIMAL(19,4),
  total_order_cvs STRING,
  data_source STRING,
  dw_etl_date STRING,
  dw_batch_id STRING,
  mapworks STRING,
  rules STRING,
  keyword STRING,
  niname STRING,
  mdm_productline_id STRING,
  emedia_category_id STRING,
  emedia_brand_id STRING,
  mdm_category_id STRING,
  mdm_brand_id STRING,
  campaign_subtype STRING,
  keyword_type STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_keyword_daily_old';

DROP TABLE IF EXISTS `dwd`.`jdkc_adgroup_daily_old_v2`;
CREATE TABLE dwd.jdkc_adgroup_daily_old_v2 (
  ad_date TIMESTAMP,
  pin_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  req_isdaily STRING,
  req_isorderorclick STRING,
  req_istodayor15days STRING,
  effect_days STRING,
  req_orderstatuscategory STRING,
  mobiletype STRING,
  clicks BIGINT,
  cost DECIMAL(19,4),
  direct_order_quantity INT,
  direct_order_value DECIMAL(19,4),
  impressions BIGINT,
  indirect_order_quantity INT,
  indirect_order_value DECIMAL(19,4),
  total_cart_quantity INT,
  order_quantity INT,
  order_value DECIMAL(19,4),
  depth_passenger_quantity INT,
  visit_time_length INT,
  visit_page_quantity INT,
  new_customer_quantity INT,
  favorite_item_quantity INT,
  favorite_shop_quantity INT,
  preorder_quantity INT,
  coupon_quantity INT,
  visitor_quantity INT,
  data_source STRING,
  dw_etl_date TIMESTAMP,
  dw_batch_id STRING,
  pin_id STRING,
  map_works STRING,
  niname STRING,
  mapworks STRING,
  source STRING,
  total_order_roi STRING,
  total_order_cvs STRING,
  indirect_cart_cnt STRING,
  direct_cart_cnt STRING,
  cpc STRING,
  cpa STRING,
  ctr STRING,
  cpm STRING,
  effect STRING,
  sub_type STRING,
  mdm_productline_id STRING,
  emedia_category_id STRING,
  emedia_brand_id STRING,
  mdm_category_id STRING,
  mdm_brand_id STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_adgroup_daily_old_v2';


DROP TABLE IF EXISTS `dwd`.`jdkc_adgroup_daily_old`;
CREATE TABLE dwd.jdkc_adgroup_daily_old (
  ad_date TIMESTAMP,
  pin_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  req_isdaily STRING,
  req_isorderorclick STRING,
  req_istodayor15days STRING,
  effect_days STRING,
  req_orderstatuscategory STRING,
  mobiletype STRING,
  clicks INT,
  cost DECIMAL(20,4),
  direct_order_quantity INT,
  direct_order_value DECIMAL(20,4),
  impressions INT,
  indirect_order_quantity INT,
  indirect_order_value DECIMAL(20,4),
  total_cart_quantity INT,
  total_order_roi DECIMAL(20,4),
  total_order_cvs DECIMAL(20,4),
  indirect_cart_cnt INT,
  direct_cart_cnt INT,
  cpc DECIMAL(20,4),
  cpa DECIMAL(20,4),
  ctr DECIMAL(20,4),
  cpm DECIMAL(20,4),
  order_quantity INT,
  order_value DECIMAL(20,4),
  effect STRING,
  depth_passenger_quantity INT,
  visit_time_length INT,
  visit_page_quantity INT,
  new_customer_quantity INT,
  favorite_item_quantity INT,
  favorite_shop_quantity INT,
  preorder_quantity INT,
  coupon_quantity INT,
  visitor_quantity INT,
  data_source STRING,
  dw_etl_date TIMESTAMP,
  dw_batch_id STRING,
  source STRING,
  sub_type STRING,
  mdm_brand_id STRING,
  mdm_category_id STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_adgroup_daily_old';