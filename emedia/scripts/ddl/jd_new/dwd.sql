DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_jdkc_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_jdkc_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_subtype` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `sku_id` STRING,
  `keyword_type` STRING,
  `niname` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `delivery_version` STRING,
  `delivery_type` STRING,
  `mobile_type` STRING,
  `source` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `put_type` STRING,
  `campaign_put_type` STRING,
  `targeting_type` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_value` DECIMAL(20,4),
  `total_cart_quantity` BIGINT,
  `new_customer_quantity` INT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_jdkc_daily_fact';


DROP TABLE IF EXISTS `dwd`.`jdkc_keyword_daily_old`;
CREATE TABLE dwd.jdkc_keyword_daily_old (
  ad_date TIMESTAMP,
  pin_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  keyword_name STRING,
  type STRING,
  req_isorderorclick STRING,
  req_clickororderday STRING,
  effect STRING,
  effect_days STRING,
  req_orderstatuscategory STRING,
  mobiletype STRING,
  clicks DECIMAL(19,4),
  cost DECIMAL(19,4),
  ctr STRING,
  cpm STRING,
  cpc STRING,
  totalorderroi STRING,
  impressions DECIMAL(19,4),
  order_quantity DECIMAL(19,4),
  order_value DECIMAL(19,4),
  indirect_order_quantity STRING,
  direct_order_quantity STRING,
  indirect_order_value STRING,
  direct_order_value STRING,
  indirectcartcnt STRING,
  directcartcnt STRING,
  total_cart_quantity DECIMAL(19,4),
  total_order_cvs STRING,
  data_source STRING,
  dw_etl_date STRING,
  dw_batch_id STRING,
  mapworks STRING,
  rules STRING,
  keyword STRING,
  niname STRING,
  mdm_productline_id STRING,
  emedia_category_id STRING,
  emedia_brand_id STRING,
  mdm_category_id STRING,
  mdm_brand_id STRING,
  campaign_subtype STRING,
  keyword_type STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_keyword_daily_old';

DROP TABLE IF EXISTS `dwd`.`jdkc_adgroup_daily_old_v2`;
CREATE TABLE dwd.jdkc_adgroup_daily_old_v2 (
  ad_date TIMESTAMP,
  pin_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  req_isdaily STRING,
  req_isorderorclick STRING,
  req_istodayor15days STRING,
  effect_days STRING,
  req_orderstatuscategory STRING,
  mobiletype STRING,
  clicks BIGINT,
  cost DECIMAL(19,4),
  direct_order_quantity INT,
  direct_order_value DECIMAL(19,4),
  impressions BIGINT,
  indirect_order_quantity INT,
  indirect_order_value DECIMAL(19,4),
  total_cart_quantity INT,
  order_quantity INT,
  order_value DECIMAL(19,4),
  depth_passenger_quantity INT,
  visit_time_length INT,
  visit_page_quantity INT,
  new_customer_quantity INT,
  favorite_item_quantity INT,
  favorite_shop_quantity INT,
  preorder_quantity INT,
  coupon_quantity INT,
  visitor_quantity INT,
  data_source STRING,
  dw_etl_date TIMESTAMP,
  dw_batch_id STRING,
  pin_id STRING,
  map_works STRING,
  niname STRING,
  mapworks STRING,
  source STRING,
  total_order_roi STRING,
  total_order_cvs STRING,
  indirect_cart_cnt STRING,
  direct_cart_cnt STRING,
  cpc STRING,
  cpa STRING,
  ctr STRING,
  cpm STRING,
  effect STRING,
  sub_type STRING,
  mdm_productline_id STRING,
  emedia_category_id STRING,
  emedia_brand_id STRING,
  mdm_category_id STRING,
  mdm_brand_id STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_adgroup_daily_old_v2';


DROP TABLE IF EXISTS `dwd`.`jdkc_adgroup_daily_old`;
CREATE TABLE dwd.jdkc_adgroup_daily_old (
  ad_date TIMESTAMP,
  pin_name STRING,
  campaign_id STRING,
  campaign_name STRING,
  adgroup_id STRING,
  adgroup_name STRING,
  category_id STRING,
  brand_id STRING,
  req_isdaily STRING,
  req_isorderorclick STRING,
  req_istodayor15days STRING,
  effect_days STRING,
  req_orderstatuscategory STRING,
  mobiletype STRING,
  clicks INT,
  cost DECIMAL(20,4),
  direct_order_quantity INT,
  direct_order_value DECIMAL(20,4),
  impressions INT,
  indirect_order_quantity INT,
  indirect_order_value DECIMAL(20,4),
  total_cart_quantity INT,
  total_order_roi DECIMAL(20,4),
  total_order_cvs DECIMAL(20,4),
  indirect_cart_cnt INT,
  direct_cart_cnt INT,
  cpc DECIMAL(20,4),
  cpa DECIMAL(20,4),
  ctr DECIMAL(20,4),
  cpm DECIMAL(20,4),
  order_quantity INT,
  order_value DECIMAL(20,4),
  effect STRING,
  depth_passenger_quantity INT,
  visit_time_length INT,
  visit_page_quantity INT,
  new_customer_quantity INT,
  favorite_item_quantity INT,
  favorite_shop_quantity INT,
  preorder_quantity INT,
  coupon_quantity INT,
  visitor_quantity INT,
  data_source STRING,
  dw_etl_date TIMESTAMP,
  dw_batch_id STRING,
  source STRING,
  sub_type STRING,
  mdm_brand_id STRING,
  mdm_category_id STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_adgroup_daily_old';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_jdzt_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_jdzt_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mobile_type` STRING,
  `media_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_value` DECIMAL(20,4),
  `total_cart_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `dw_source` STRING,
  `dw_create_time` DATE,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_jdzt_daily_fact';

DROP TABLE IF EXISTS `dwd`.`jdzt_account_daily_mapping_success`;
CREATE TABLE `dwd`.`jdzt_account_daily_mapping_success` (
  `ad_date` DATE,
  `pin_name` STRING,
  `pin_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `click_date` DATE,
  `platform_cnt` BIGINT,
  `platform_gmv` DECIMAL(20,4),
  `department_cnt` BIGINT,
  `department_gmv` DECIMAL(20,4),
  `channel_roi` DECIMAL(20,4),
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_account_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`jdzt_account_daily_mapping_fail`;
CREATE TABLE `dwd`.`jdzt_account_daily_mapping_fail` (
  `ad_date` DATE,
  `pin_name` STRING,
  `pin_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `click_date` DATE,
  `platform_cnt` BIGINT,
  `platform_gmv` DECIMAL(20,4),
  `department_cnt` BIGINT,
  `department_gmv` DECIMAL(20,4),
  `channel_roi` DECIMAL(20,4),
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_account_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`jdzt_account_daily`;
CREATE TABLE `dwd`.`jdzt_account_daily` (
  `ad_date` DATE,
  `pin_name` STRING,
  `pin_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `click_date` DATE,
  `platform_cnt` BIGINT,
  `platform_gmv` DECIMAL(20,4),
  `department_cnt` BIGINT,
  `department_gmv` DECIMAL(20,4),
  `channel_roi` DECIMAL(20,4),
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_account_daily';

DROP TABLE IF EXISTS `dwd`.`jdzt_account_daily_old`;
CREATE TABLE `dwd`.`jdzt_account_daily_old` (
  `ad_date` DATE,
  `pin_name` STRING,
  `pin_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `click_date` DATE,
  `platform_cnt` BIGINT,
  `platform_gmv` DECIMAL(20,4),
  `department_cnt` BIGINT,
  `department_gmv` DECIMAL(20,4),
  `channel_roi` DECIMAL(20,4),
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_account_daily_old';

DROP TABLE IF EXISTS `dwd`.`jdzt_account_daily_old_v2`;
CREATE TABLE `dwd`.`jdzt_account_daily_old_v2` (
  `ad_date` DATE,
  `pin_name` STRING,
  `pin_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `click_date` DATE,
  `platform_cnt` BIGINT,
  `platform_gmv` DECIMAL(20,4),
  `department_cnt` BIGINT,
  `department_gmv` DECIMAL(20,4),
  `channel_roi` DECIMAL(20,4),
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_account_daily_old_v2';

DROP TABLE IF EXISTS `dwd`.`jdzt_adgroup_daily_mapping_success`;
CREATE TABLE `dwd`.`jdzt_adgroup_daily_mapping_success` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `order_cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visitor_quantity` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `tencent_picture_click_cnt` BIGINT,
  `tencent_comment_cnt` BIGINT,
  `tencent_read_cnt` BIGINT,
  `tencent_like_cnt` BIGINT,
  `tencent_read_ratio` BIGINT,
  `tencent_share_cnt` BIGINT,
  `tencent_follow_cnt` BIGINT,
  `interact_cnt` BIGINT,
  `live_cost` DECIMAL(20,4),
  `form_commit_cnt` BIGINT,
  `form_commit_cost` DECIMAL(20,4),
  `click_date` DATE,
  `media_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_adgroup_daily_mapping_success';


DROP TABLE IF EXISTS `dwd`.`jdzt_adgroup_daily_mapping_fail`;
CREATE TABLE `dwd`.`jdzt_adgroup_daily_mapping_fail` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `order_cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visitor_quantity` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `tencent_picture_click_cnt` BIGINT,
  `tencent_comment_cnt` BIGINT,
  `tencent_read_cnt` BIGINT,
  `tencent_like_cnt` BIGINT,
  `tencent_read_ratio` BIGINT,
  `tencent_share_cnt` BIGINT,
  `tencent_follow_cnt` BIGINT,
  `interact_cnt` BIGINT,
  `live_cost` DECIMAL(20,4),
  `form_commit_cnt` BIGINT,
  `form_commit_cost` DECIMAL(20,4),
  `click_date` DATE,
  `media_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_adgroup_daily_mapping_fail';


DROP TABLE IF EXISTS `dwd`.`jdzt_adgroup_daily`;
CREATE TABLE `dwd`.`jdzt_adgroup_daily` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `order_cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visitor_quantity` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `tencent_picture_click_cnt` BIGINT,
  `tencent_comment_cnt` BIGINT,
  `tencent_read_cnt` BIGINT,
  `tencent_like_cnt` BIGINT,
  `tencent_read_ratio` BIGINT,
  `tencent_share_cnt` BIGINT,
  `tencent_follow_cnt` BIGINT,
  `interact_cnt` BIGINT,
  `live_cost` DECIMAL(20,4),
  `form_commit_cnt` BIGINT,
  `form_commit_cost` DECIMAL(20,4),
  `click_date` DATE,
  `media_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_adgroup_daily';


DROP TABLE IF EXISTS `dwd`.`jdzt_adgroup_daily_old`;
CREATE TABLE `dwd`.`jdzt_adgroup_daily_old` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `order_cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visitor_quantity` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `tencent_picture_click_cnt` BIGINT,
  `tencent_comment_cnt` BIGINT,
  `tencent_read_cnt` BIGINT,
  `tencent_like_cnt` BIGINT,
  `tencent_read_ratio` BIGINT,
  `tencent_share_cnt` BIGINT,
  `tencent_follow_cnt` BIGINT,
  `interact_cnt` BIGINT,
  `live_cost` DECIMAL(20,4),
  `form_commit_cnt` BIGINT,
  `form_commit_cost` DECIMAL(20,4),
  `click_date` DATE,
  `media_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzt_adgroup_daily_old';

DROP TABLE IF EXISTS `dwd`.`jdzw_campaign_daily_mapping_success`;
CREATE TABLE `dwd`.`jdzw_campaign_daily_mapping_success` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_cnt` BIGINT,
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `put_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `click_date` DATE,
  `delivery_version` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_campaign_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`jdzw_campaign_daily_mapping_fail`;
CREATE TABLE `dwd`.`jdzw_campaign_daily_mapping_fail` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_cnt` BIGINT,
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `put_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `click_date` DATE,
  `delivery_version` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_campaign_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`jdzw_campaign_daily`;
CREATE TABLE `dwd`.`jdzw_campaign_daily` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_cnt` BIGINT,
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `put_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `click_date` DATE,
  `delivery_version` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_campaign_daily';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_jdzw_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_jdzw_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `audience_name` STRING,
  `sku_id` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `put_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_value` DECIMAL(20,4),
  `total_cart_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `dw_source` STRING,
  `dw_create_time` DATE,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_jdzw_daily_fact';

DROP TABLE IF EXISTS `dwd`.`jdzw_creative_daily_mapping_success`;
CREATE TABLE `dwd`.`jdzw_creative_daily_mapping_success` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `ad_id` STRING,
  `ad_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `follow_cnt` STRING,
  `like_cnt` STRING,
  `interact_cnt` STRING,
  `comment_cnt` STRING,
  `pull_customer_cnt` STRING,
  `pull_customer_cpc` STRING,
  `share_cnt` STRING,
  `ir` DECIMAL(20,4),
  `click_date` DATE,
  `status` STRING,
  `campaign_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_creative_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`jdzw_creative_daily_mapping_fail`;
CREATE TABLE `dwd`.`jdzw_creative_daily_mapping_fail` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `ad_id` STRING,
  `ad_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `follow_cnt` STRING,
  `like_cnt` STRING,
  `interact_cnt` STRING,
  `comment_cnt` STRING,
  `pull_customer_cnt` STRING,
  `pull_customer_cpc` STRING,
  `share_cnt` STRING,
  `ir` DECIMAL(20,4),
  `click_date` DATE,
  `status` STRING,
  `campaign_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_creative_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`jdzw_creative_daily`;
CREATE TABLE `dwd`.`jdzw_creative_daily` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `ad_id` STRING,
  `ad_name` STRING,
  `sku_id` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `follow_cnt` STRING,
  `like_cnt` STRING,
  `interact_cnt` STRING,
  `comment_cnt` STRING,
  `pull_customer_cnt` STRING,
  `pull_customer_cpc` STRING,
  `share_cnt` STRING,
  `ir` DECIMAL(20,4),
  `click_date` DATE,
  `status` STRING,
  `campaign_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `audience_name` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_creative_daily';

DROP TABLE IF EXISTS `dwd`.`jdzw_creative_daily_old`;
CREATE TABLE `dwd`.`jdzw_creative_daily_old` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `ad_id` STRING,
  `ad_name` STRING,
  `sku_id` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `follow_cnt` STRING,
  `like_cnt` STRING,
  `interact_cnt` STRING,
  `comment_cnt` STRING,
  `pull_customer_cnt` STRING,
  `pull_customer_cpc` STRING,
  `share_cnt` STRING,
  `ir` DECIMAL(20,4),
  `click_date` DATE,
  `status` STRING,
  `campaign_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `audience_name` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_creative_daily_old';

DROP TABLE IF EXISTS `dwd`.`jdzw_creative_daily_old_v2`;
CREATE TABLE `dwd`.`jdzw_creative_daily_old_v2` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `ad_id` STRING,
  `ad_name` STRING,
  `sku_id` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `follow_cnt` STRING,
  `like_cnt` STRING,
  `interact_cnt` STRING,
  `comment_cnt` STRING,
  `pull_customer_cnt` STRING,
  `pull_customer_cpc` STRING,
  `share_cnt` STRING,
  `ir` DECIMAL(20,4),
  `click_date` DATE,
  `status` STRING,
  `campaign_type` STRING,
  `mobile_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `audience_name` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdzw_creative_daily_old_v2';

DROP TABLE IF EXISTS `dwd`.`jdfa_order_daily_mapping_success`;
CREATE TABLE `dwd`.`jdfa_order_daily_mapping_success` (
  `order_type` STRING,
  `cost` DECIMAL(19,4),
  `order_no` STRING,
  `pin_name` STRING,
  `ad_date` DATE,
  `campaign_id` STRING,
  `user_id` STRING,
  `ordertype7` STRING,
  `total_amount` DECIMAL(19,4),
  `req_beginDate` STRING,
  `req_endDate` STRING,
  `money_type` STRING,
  `req_subPin` STRING,
  `pin` STRING,
  `dw_create_time` STRING,
  `dw_source` STRING,
  `dw_batch_number` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdfa_order_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`jdfa_order_daily_mapping_fail`;
CREATE TABLE `dwd`.`jdfa_order_daily_mapping_fail` (
  `order_type` STRING,
  `cost` DECIMAL(19,4),
  `order_no` STRING,
  `pin_name` STRING,
  `ad_date` DATE,
  `campaign_id` STRING,
  `user_id` STRING,
  `ordertype7` STRING,
  `total_amount` DECIMAL(19,4),
  `req_beginDate` STRING,
  `req_endDate` STRING,
  `money_type` STRING,
  `req_subPin` STRING,
  `pin` STRING,
  `dw_create_time` STRING,
  `dw_source` STRING,
  `dw_batch_number` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdfa_order_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`jdfa_order_daily`;
CREATE TABLE `dwd`.`jdfa_order_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin` STRING,
  `pin_name` STRING,
  `money_type` STRING,
  `order_type` STRING,
  `order_no` STRING,
  `campaign_id` STRING,
  `user_id` STRING,
  `cost` DECIMAL(19,4),
  `total_amount` DECIMAL(19,4),
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `ordertype7` STRING,
  `req_beginDate` STRING,
  `req_endDate` STRING,
  `req_subPin` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdfa_order_daily';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_jdfa_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_jdfa_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin` STRING,
  `pin_name` STRING,
  `money_type` STRING,
  `order_type` STRING,
  `order_no` STRING,
  `campaign_id` STRING,
  `user_id` STRING,
  `cost` DECIMAL(19,4),
  `total_amount` DECIMAL(19,4),
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_jdfa_daily_fact';

DROP TABLE IF EXISTS `dwd`.`jd_ppzq_campaign_daily_mapping_success`;
CREATE TABLE `dwd`.`jd_ppzq_campaign_daily_mapping_success` (
  `brandName` STRING,
  `campaignName` STRING,
  `clicks` BIGINT,
  `ctr` DOUBLE,
  `ad_date` DATE,
  `firstCateName` STRING,
  `impressions` BIGINT,
  `realPrice` DOUBLE,
  `spaceName` STRING,
  `queries` INT,
  `secondCateName` STRING,
  `total_cart_cnt` BIGINT,
  `total_deal_order_cnt` BIGINT,
  `total_deal_order_sum` DECIMAL(19,4),
  `pin_name` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jd_ppzq_campaign_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`jd_ppzq_campaign_daily_mapping_fail`;
CREATE TABLE `dwd`.`jd_ppzq_campaign_daily_mapping_fail` (
  `brandName` STRING,
  `campaignName` STRING,
  `clicks` BIGINT,
  `ctr` DOUBLE,
  `ad_date` DATE,
  `firstCateName` STRING,
  `impressions` BIGINT,
  `realPrice` DOUBLE,
  `spaceName` STRING,
  `queries` INT,
  `secondCateName` STRING,
  `total_cart_cnt` BIGINT,
  `total_deal_order_cnt` BIGINT,
  `total_deal_order_sum` DECIMAL(19,4),
  `pin_name` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jd_ppzq_campaign_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`jd_ppzq_campaign_daily`;
CREATE TABLE `dwd`.`jd_ppzq_campaign_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `cost` DECIMAL(19,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `total_deal_order_cnt` BIGINT,
  `total_deal_order_sum` DECIMAL(19,4),
  `total_cart_cnt` BIGINT,
  `uv_impressions` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `brandName` STRING,
  `campaignName` STRING,
  `ctr` DOUBLE,
  `firstCateName` STRING,
  `realPrice` DOUBLE,
  `spaceName` STRING,
  `queries` INT,
  `secondCateName` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jd_ppzq_campaign_daily';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_jd_ppzq_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_jd_ppzq_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `cost` DECIMAL(19,4),
  `click` BIGINT,
  `impression` BIGINT,
  `total_deal_order_cnt` BIGINT,
  `total_deal_order_sum` DECIMAL(19,4),
  `total_cart_cnt` BIGINT,
  `uv_impressions` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_jd_ppzq_daily_fact';






DROP TABLE IF EXISTS `dwd`.`jdkc_target_daily_mapping_fail`;
CREATE TABLE `dwd`.`jdkc_target_daily_mapping_fail` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `target_audience_id` STRING,
  `target_audience_name` STRING,
  `dmpFactor` BIGINT,
  `dmpStatus` BOOLEAN,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `dw_batch_id` STRING,
  `req_page` INT,
  `req_pageSize` INT,
  `dw_create_time` BIGINT,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_target_daily_mapping_fail';


DROP TABLE IF EXISTS `dwd`.`jdkc_target_daily_mapping_success`;
CREATE TABLE `dwd`.`jdkc_target_daily_mapping_success` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `target_audience_id` STRING,
  `target_audience_name` STRING,
  `dmpFactor` BIGINT,
  `dmpStatus` BOOLEAN,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `dw_batch_id` STRING,
  `req_page` INT,
  `req_pageSize` INT,
  `dw_create_time` BIGINT,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_target_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`jdkc_target_daily`;
CREATE TABLE `dwd`.`jdkc_target_daily` (
  `ad_date` DATE,
  `pin_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `target_audience_id` STRING,
  `target_audience_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `mdm_productline_id` STRING,
  `campaign_subtype` STRING,
  `audience_name` STRING,
  `dmpFactor` BIGINT,
  `dmpStatus` BOOLEAN,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `dw_batch_id` STRING,
  `req_page` INT,
  `req_pageSize` INT,
  `dw_create_time` BIGINT,
  `data_source` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/jdkc_target_daily';


