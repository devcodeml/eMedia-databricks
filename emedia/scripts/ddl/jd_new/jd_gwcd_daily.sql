DROP TABLE IF EXISTS `stg`.`gwcd_adgroup_daily`;
CREATE TABLE IF NOT EXISTS `stg`.`gwcd_adgroup_daily` (
  `date` STRING,
  `adBillingType` STRING,
  `IR` STRING,
  `adGroupId` STRING,
  `pin` STRING,
  `commentCnt` STRING,
  `followCnt` STRING,
  `shareCnt` STRING,
  `campaignType` STRING,
  `adGroupName` STRING,
  `campaignId` STRING,
  `deliveryType` STRING,
  `likeCnt` STRING,
  `retrievalType2` STRING,
  `retrievalType0` STRING,
  `retrievalType1` STRING,
  `interactCnt` STRING,
  `campaignName` STRING,
  `req_giftFlag` STRING,
  `req_startDay` STRING,
  `req_endDay` STRING,
  `req_clickOrOrderDay` STRING,
  `req_orderStatusCategory` STRING,
  `req_page` STRING,
  `req_pageSize` STRING,
  `req_impressionOrClickEffect` STRING,
  `req_clickOrOrderCaliber` STRING,
  `req_isDaily` STRING,
  `req_businessType` STRING,
  `req_pin` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_stg.db/gwcd_adgroup_daily';

DROP TABLE IF EXISTS `ods`.`gwcd_adgroup_daily`;
CREATE TABLE IF NOT EXISTS `ods`.`gwcd_adgroup_daily` (
  `ad_date` DATE,
  `pin` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaignName` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_cnt` BIGINT,
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `video_interact_rate` DECIMAL(9,4),
  `video_efficientplay_cnt` BIGINT,
  `video_finish_rate` DECIMAL(9,4),
  `video_comment_cnt` BIGINT,
  `video_uv` BIGINT,
  `video_play_time_sum` DECIMAL(20,4),
  `video_click_uv` BIGINT,
  `watch_time_avg` DECIMAL(20,4),
  `video_interact_cnt` BIGINT,
  `video_efficientplay_rate` DECIMAL(20,4),
  `watch_time_sum` DECIMAL(20,4),
  `video_finish_cnt` BIGINT,
  `video_like_cnt` BIGINT,
  `video_play_cnt` BIGINT,
  `watch_cnt` BIGINT,
  `video_share_cnt` BIGINT,
  `ad_billing_type` STRING,
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `campaign_type` STRING,
  `delivery_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `source` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_ods.db/gwcd_adgroup_daily';

DROP TABLE IF EXISTS `dwd`.`gwcd_adgroup_daily_mapping_success`;
CREATE TABLE IF NOT EXISTS `dwd`.`gwcd_adgroup_daily_mapping_success` (
  `ad_date` DATE,
  `pin` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaignName` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_cnt` BIGINT,
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `video_interact_rate` DECIMAL(9,4),
  `video_efficientplay_cnt` BIGINT,
  `video_finish_rate` DECIMAL(9,4),
  `video_comment_cnt` BIGINT,
  `video_uv` BIGINT,
  `video_play_time_sum` DECIMAL(20,4),
  `video_click_uv` BIGINT,
  `watch_time_avg` DECIMAL(20,4),
  `video_interact_cnt` BIGINT,
  `video_efficientplay_rate` DECIMAL(20,4),
  `watch_time_sum` DECIMAL(20,4),
  `video_finish_cnt` BIGINT,
  `video_like_cnt` BIGINT,
  `video_play_cnt` BIGINT,
  `watch_cnt` BIGINT,
  `video_share_cnt` BIGINT,
  `ad_billing_type` STRING,
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `campaign_type` STRING,
  `delivery_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `source` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_adgroup_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`gwcd_adgroup_daily_mapping_fail`;
CREATE TABLE IF NOT EXISTS `dwd`.`gwcd_adgroup_daily_mapping_fail` (
  `ad_date` DATE,
  `pin` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaignName` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_cnt` BIGINT,
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `video_interact_rate` DECIMAL(9,4),
  `video_efficientplay_cnt` BIGINT,
  `video_finish_rate` DECIMAL(9,4),
  `video_comment_cnt` BIGINT,
  `video_uv` BIGINT,
  `video_play_time_sum` DECIMAL(20,4),
  `video_click_uv` BIGINT,
  `watch_time_avg` DECIMAL(20,4),
  `video_interact_cnt` BIGINT,
  `video_efficientplay_rate` DECIMAL(20,4),
  `watch_time_sum` DECIMAL(20,4),
  `video_finish_cnt` BIGINT,
  `video_like_cnt` BIGINT,
  `video_play_cnt` BIGINT,
  `watch_cnt` BIGINT,
  `video_share_cnt` BIGINT,
  `ad_billing_type` STRING,
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `campaign_type` STRING,
  `delivery_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `source` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_adgroup_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`gwcd_adgroup_daily`;
CREATE TABLE IF NOT EXISTS `dwd`.`gwcd_adgroup_daily` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_cnt` BIGINT,
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_cnt` BIGINT,
  `total_presale_order_sum` DECIMAL(20,4),
  `video_interact_rate` DECIMAL(9,4),
  `video_efficientplay_cnt` BIGINT,
  `video_finish_rate` DECIMAL(9,4),
  `video_comment_cnt` BIGINT,
  `video_uv` BIGINT,
  `video_play_time_sum` DECIMAL(20,4),
  `video_click_uv` BIGINT,
  `watch_time_avg` DECIMAL(20,4),
  `video_interact_cnt` BIGINT,
  `video_efficientplay_rate` DECIMAL(20,4),
  `watch_time_sum` DECIMAL(20,4),
  `video_finish_cnt` BIGINT,
  `video_like_cnt` BIGINT,
  `video_play_cnt` BIGINT,
  `watch_cnt` BIGINT,
  `video_share_cnt` BIGINT,
  `ad_billing_type` STRING,
  `ir` DECIMAL(20,4),
  `like_cnt` BIGINT,
  `comment_cnt` BIGINT,
  `follow_cnt` BIGINT,
  `share_cnt` BIGINT,
  `campaign_type` STRING,
  `delivery_type` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `source` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_adgroup_daily';

DROP TABLE IF EXISTS `stg`.`gwcd_campaign_daily`;
CREATE TABLE IF NOT EXISTS `stg`.`gwcd_campaign_daily` (
  `CTR` STRING,
  `depthPassengerCnt` STRING,
  `date` STRING,
  `CPM` STRING,
  `presaleIndirectOrderSum` STRING,
  `putType` STRING,
  `presaleDirectOrderCnt` STRING,
  `preorderCnt` STRING,
  `indirectOrderCnt` STRING,
  `clickDate` STRING,
  `directOrderCnt` STRING,
  `indirectCartCnt` STRING,
  `pin` STRING,
  `visitPageCnt` STRING,
  `deliveryVersion` STRING,
  `visitTimeAverage` STRING,
  `totalPresaleOrderSum` STRING,
  `directCartCnt` STRING,
  `visitorCnt` STRING,
  `campaignType` STRING,
  `campaignPutType` STRING,
  `cost` STRING,
  `couponCnt` STRING,
  `totalOrderSum` STRING,
  `totalCartCnt` STRING,
  `presaleIndirectOrderCnt` STRING,
  `campaignId` STRING,
  `totalOrderROI` STRING,
  `newCustomersCnt` STRING,
  `mobileType` STRING,
  `impressions` STRING,
  `indirectOrderSum` STRING,
  `directOrderSum` STRING,
  `goodsAttentionCnt` STRING,
  `totalOrderCVS` STRING,
  `CPA` STRING,
  `CPC` STRING,
  `totalPresaleOrderCnt` STRING,
  `presaleDirectOrderSum` STRING,
  `clicks` STRING,
  `totalOrderCnt` STRING,
  `shopAttentionCnt` STRING,
  `campaignName` STRING,
  `req_giftFlag` STRING,
  `req_startDay` STRING,
  `req_endDay` STRING,
  `req_clickOrOrderDay` STRING,
  `req_orderStatusCategory` STRING,
  `req_page` STRING,
  `req_pageSize` STRING,
  `req_impressionOrClickEffect` STRING,
  `req_clickOrOrderCaliber` STRING,
  `req_isDaily` STRING,
  `req_businessType` STRING,
  `req_pin` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_stg.db/gwcd_campaign_daily';

DROP TABLE IF EXISTS `ods`.`gwcd_campaign_daily`;
CREATE TABLE IF NOT EXISTS `ods`.`gwcd_campaign_daily` (
  `ad_date` DATE,
  `pin` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaignName` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `deliveryVersion` STRING,
  `put_type` STRING,
  `mobile_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `click_date` DATE,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_ods.db/gwcd_campaign_daily';

DROP TABLE IF EXISTS `dwd`.`gwcd_campaign_daily_mapping_success`;
CREATE TABLE IF NOT EXISTS `dwd`.`gwcd_campaign_daily_mapping_success` (
  `ad_date` DATE,
  `pin` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaignName` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `deliveryVersion` STRING,
  `put_type` STRING,
  `mobile_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `click_date` DATE,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_campaign_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`gwcd_campaign_daily_mapping_fail`;
CREATE TABLE IF NOT EXISTS `dwd`.`gwcd_campaign_daily_mapping_fail` (
  `ad_date` DATE,
  `pin` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaignName` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `deliveryVersion` STRING,
  `put_type` STRING,
  `mobile_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `click_date` DATE,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `dw_batch_id` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_campaign_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`gwcd_campaign_daily`;
CREATE TABLE IF NOT EXISTS `dwd`.`gwcd_campaign_daily` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `deliveryVersion` STRING,
  `put_type` STRING,
  `mobile_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `click_date` DATE,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_campaign_daily';


DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_gwcd_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_gwcd_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `campaign_type` STRING,
  `delivery_version` STRING,
  `delivery_type` STRING,
  `mobile_type` STRING,
  `source` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `put_type` STRING,
  `campaign_put_type` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_value` DECIMAL(20,4),
  `total_cart_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_update_time` TIMESTAMP,
  `etl_create_time` TIMESTAMP)
USING delta
PARTITIONED BY (`report_level`, `etl_source_table`)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_gwcd_daily_fact';

DROP TABLE IF EXISTS `stg`.`gwcd_campaign_daily_old_v2`;
CREATE TABLE `stg`.`gwcd_campaign_daily_old_v2` (
  `ad_date` TIMESTAMP,
  `pin_name` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `campaign_type` STRING,
  `click_or_order_caliber` STRING,
  `effect` STRING,
  `ad_billing_type` STRING,
  `impressions` DECIMAL(20,8),
  `clicks` DECIMAL(20,8),
  `cost` DECIMAL(20,8),
  `ctr` DECIMAL(20,8),
  `cpm` DECIMAL(20,8),
  `cpc` DECIMAL(20,8),
  `direct_order_sum` DECIMAL(20,8),
  `indirect_order_cnt` DECIMAL(20,8),
  `indirect_order_sum` DECIMAL(20,8),
  `total_order_cnt` DECIMAL(20,8),
  `total_order_sum` DECIMAL(20,8),
  `direct_cart_cnt` DECIMAL(20,8),
  `indirect_cart_cnt` DECIMAL(20,8),
  `total_cart_cnt` DECIMAL(20,8),
  `total_order_cvs` DECIMAL(20,8),
  `total_order_roi` DECIMAL(20,8),
  `direct_order_cnt` DECIMAL(20,8),
  `new_customers_cnt` DECIMAL(20,8),
  `visitor_cnt` DECIMAL(20,8),
  `visit_page_cnt` DECIMAL(20,8),
  `visit_time_average` DECIMAL(20,8),
  `depth_passenger_cnt` DECIMAL(20,8),
  `shop_attention_cnt` DECIMAL(20,8),
  `goods_attention_cnt` DECIMAL(20,8),
  `preorder_cnt` DECIMAL(20,8),
  `coupon_cnt` DECIMAL(20,8),
  `data_source` STRING,
  `dw_etl_date` STRING,
  `dw_batch_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_stg.db/gwcd_campaign_daily_old_v2';

DROP TABLE IF EXISTS `dwd`.`gwcd_campaign_daily_old_v2`;
CREATE TABLE `dwd`.`gwcd_campaign_daily_old_v2` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `deliveryVersion` STRING,
  `put_type` STRING,
  `mobile_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `click_date` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_campaign_daily_old_v2';

DROP TABLE IF EXISTS `stg`.`gwcd_campaign_daily_old`;
CREATE TABLE `stg`.`gwcd_campaign_daily_old` (
  `ad_date` TIMESTAMP,
  `pin_name` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `effect_days` STRING,
  `impressions` DECIMAL(20,8),
  `clicks` DECIMAL(20,8),
  `cost` DECIMAL(20,8),
  `indirectCartCnt` DECIMAL(20,8),
  `indirectOrderCnt` DECIMAL(20,8),
  `indirectOrderSum` DECIMAL(20,8),
  `directCartCnt` DECIMAL(20,8),
  `directOrderCnt` DECIMAL(20,8),
  `directOrderSum` DECIMAL(20,8),
  `totalCartCnt` DECIMAL(20,8),
  `totalOrderCnt` DECIMAL(20,8),
  `totalOrderSum` DECIMAL(20,8),
  `adBillingType` DECIMAL(20,8),
  `campaign_put_type` DECIMAL(20,8),
  `campaign_type` DECIMAL(20,8),
  `campaign_type_expand` DECIMAL(20,8),
  `commentCnt` DECIMAL(20,8),
  `couponCnt` DECIMAL(20,8),
  `CPA` DECIMAL(20,8),
  `CPC` DECIMAL(20,8),
  `CPM` DECIMAL(20,8),
  `CTR` DECIMAL(20,8),
  `deliveryVersion` DECIMAL(20,8),
  `depthPassengerCnt` DECIMAL(20,8),
  `followCnt` DECIMAL(20,8),
  `goodsAttentionCnt` DECIMAL(20,8),
  `interActCnt` DECIMAL(20,8),
  `IR` DECIMAL(20,8),
  `likeCnt` DECIMAL(20,8),
  `newCustomersCnt` DECIMAL(20,8),
  `newGuestScope` DECIMAL(20,8),
  `noPurchasePeriod` DECIMAL(20,8),
  `clickDate` STRING,
  `preorderCnt` DECIMAL(20,8),
  `presaleDirectOrderCnt` DECIMAL(20,8),
  `presaleDirectOrderSum` DECIMAL(20,8),
  `presaleIndirectOrderCnt` DECIMAL(20,8),
  `presaleIndirectOrderSum` DECIMAL(20,8),
  `pullCustomerCnt` DECIMAL(20,8),
  `pullCustomerCPC` DECIMAL(20,8),
  `putType` STRING,
  `scenarioType` DECIMAL(20,8),
  `shareCnt` DECIMAL(20,8),
  `shopAttentionCnt` DECIMAL(20,8),
  `totalOrderCVS` DECIMAL(20,8),
  `totalOrderROI` DECIMAL(20,8),
  `totalPresaleOrderCnt` DECIMAL(20,8),
  `totalPresaleOrderSum` DECIMAL(20,8),
  `visitorCnt` DECIMAL(20,8),
  `visitPageCnt` DECIMAL(20,8),
  `visitTimeAverage` DECIMAL(20,8),
  `watchCnt` DECIMAL(20,8),
  `watchTimeAvg` DECIMAL(20,8),
  `watchTimeSum` DECIMAL(20,8),
  `req_startDay` TIMESTAMP,
  `req_endDay` TIMESTAMP,
  `req_productName` STRING,
  `req_page` DECIMAL(20,8),
  `req_pageSize` DECIMAL(20,8),
  `req_clickOrOrderDay` DECIMAL(20,8),
  `req_clickOrOrderCaliber` DECIMAL(20,8),
  `req_isDaily` STRING,
  `mdm_brand_id` STRING,
  `mdm_category_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_stg.db/gwcd_campaign_daily_old';

DROP TABLE IF EXISTS `dwd`.`gwcd_campaign_daily_old`;
CREATE TABLE `dwd`.`gwcd_campaign_daily_old` (
  `ad_date` DATE,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `cost` DECIMAL(20,4),
  `clicks` BIGINT,
  `impressions` BIGINT,
  `cpa` STRING,
  `cpc` DECIMAL(20,4),
  `cpm` DECIMAL(20,4),
  `ctr` DECIMAL(9,4),
  `total_order_roi` DECIMAL(9,4),
  `total_order_cvs` DECIMAL(9,4),
  `direct_cart_cnt` BIGINT,
  `indirect_cart_cnt` BIGINT,
  `total_cart_quantity` BIGINT,
  `direct_order_value` DECIMAL(20,4),
  `indirect_order_value` DECIMAL(20,4),
  `order_value` DECIMAL(20,4),
  `direct_order_quantity` BIGINT,
  `indirect_order_quantity` BIGINT,
  `order_quantity` BIGINT,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `coupon_quantity` BIGINT,
  `preorder_quantity` BIGINT,
  `depth_passenger_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `visit_time_length` DECIMAL(20,4),
  `visitor_quantity` BIGINT,
  `visit_page_quantity` BIGINT,
  `presale_direct_order_cnt` BIGINT,
  `presale_indirect_order_cnt` BIGINT,
  `total_presale_order_cnt` BIGINT,
  `presale_direct_order_sum` DECIMAL(20,4),
  `presale_indirect_order_sum` DECIMAL(20,4),
  `total_presale_order_sum` DECIMAL(20,4),
  `deliveryVersion` STRING,
  `put_type` STRING,
  `mobile_type` STRING,
  `campaign_type` STRING,
  `campaign_put_type` STRING,
  `click_date` DATE,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `impression_or_click_effect` STRING,
  `start_day` DATE,
  `end_day` DATE,
  `is_daily` STRING,
  `data_source` STRING,
  `dw_batch_id` STRING,
  `dw_etl_date` DATE)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/gwcd_campaign_daily_old';

DROP TABLE IF EXISTS `ds`.`hc_emedia_gwcd_deep_dive_download_campaign_adgroup_daily_fact`;
CREATE TABLE `ds`.`hc_emedia_gwcd_deep_dive_download_campaign_adgroup_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `sku_id` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_productline_id` STRING,
  `campaign_type` STRING,
  `delivery_version` STRING,
  `delivery_type` STRING,
  `mobile_type` STRING,
  `source` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `put_type` STRING,
  `campaign_put_type` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_value` DECIMAL(20,4),
  `total_cart_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_update_time` TIMESTAMP,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_ds.db/hc_emedia_gwcd_deep_dive_download_campaign_adgroup_daily_fact';

DROP TABLE IF EXISTS `ds`.`gm_emedia_gwcd_deep_dive_download_daily_fact`;
CREATE TABLE `ds`.`gm_emedia_gwcd_deep_dive_download_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `pin_name` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `campaign_type` STRING,
  `delivery_version` STRING,
  `delivery_type` STRING,
  `mobile_type` STRING,
  `source` STRING,
  `business_type` STRING,
  `gift_flag` STRING,
  `order_status_category` STRING,
  `click_or_order_caliber` STRING,
  `put_type` STRING,
  `campaign_put_type` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_value` DECIMAL(20,4),
  `total_cart_quantity` BIGINT,
  `new_customer_quantity` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_update_time` TIMESTAMP,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_ds.db/gm_emedia_gwcd_deep_dive_download_daily_fact';
