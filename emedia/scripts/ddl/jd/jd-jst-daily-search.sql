DROP TABLE IF EXISTS `dws`.`tb_emedia_jd_jst_daily_search_mapping_success`;
CREATE TABLE IF NOT EXISTS `dws`.`tb_emedia_jd_jst_daily_search_mapping_success` (
  date STRING,
  effectOrderSum STRING,
  sharingOrderCnt STRING,
  totalAuctionMarginSum STRING,
  effectCartCnt STRING,
  indirectOrderCnt STRING,
  directOrderCnt STRING,
  indirectCartCnt STRING,
  searchTerm STRING,
  cpc STRING,
  totalPresaleOrderSum STRING,
  totalAuctionCnt STRING,
  directCartCnt STRING,
  ctr STRING,
  effectOrderCnt STRING,
  cpm STRING,
  cost STRING,
  totalOrderSum STRING,
  sharingOrderSum STRING,
  totalCartCnt STRING,
  totalOrderROI STRING,
  impressions STRING,
  indirectOrderSum STRING,
  directOrderSum STRING,
  totalOrderCVS STRING,
  totalPresaleOrderCnt STRING,
  clicks STRING,
  totalOrderCnt STRING,
  campaignName STRING,
  req_clickOrOrderCaliber STRING,
  req_clickOrOrderDay STRING,
  req_startDay STRING,
  req_endDay STRING,
  req_businessType STRING,
  req_giftFlag STRING,
  req_isDaily STRING,
  req_page STRING,
  req_pageSize STRING,
  req_orderStatusCategory STRING,
  req_pin STRING,
  dw_resource STRING,
  dw_create_time STRING,
  dw_batch_number STRING,
  campaignId STRING,
  category_id STRING,
  brand_id STRING,
  etl_date DATE,
  etl_create_time TIMESTAMP,
  dw_batch_id STRING
)
USING delta
PARTITIONED BY (`date`)
LOCATION  'dbfs:/mnt/${spark.dbr_env}/data_warehouse/media_dws.db/tb_emedia_jd_jst_daily_search_mapping_success';

DROP TABLE IF EXISTS `stg`.`tb_emedia_jd_jst_daily_search_mapping_fail`;
CREATE TABLE IF NOT EXISTS `stg`.`tb_emedia_jd_jst_daily_search_mapping_fail` (
  date STRING,
  effectOrderSum STRING,
  sharingOrderCnt STRING,
  totalAuctionMarginSum STRING,
  effectCartCnt STRING,
  indirectOrderCnt STRING,
  directOrderCnt STRING,
  indirectCartCnt STRING,
  searchTerm STRING,
  cpc STRING,
  totalPresaleOrderSum STRING,
  totalAuctionCnt STRING,
  directCartCnt STRING,
  ctr STRING,
  effectOrderCnt STRING,
  cpm STRING,
  cost STRING,
  totalOrderSum STRING,
  sharingOrderSum STRING,
  totalCartCnt STRING,
  totalOrderROI STRING,
  impressions STRING,
  indirectOrderSum STRING,
  directOrderSum STRING,
  totalOrderCVS STRING,
  totalPresaleOrderCnt STRING,
  clicks STRING,
  totalOrderCnt STRING,
  campaignName STRING,
  req_clickOrOrderCaliber STRING,
  req_clickOrOrderDay STRING,
  req_startDay STRING,
  req_endDay STRING,
  req_businessType STRING,
  req_giftFlag STRING,
  req_isDaily STRING,
  req_page STRING,
  req_pageSize STRING,
  req_orderStatusCategory STRING,
  req_pin STRING,
  dw_resource STRING,
  dw_create_time STRING,
  dw_batch_number STRING,
  campaignId STRING,
  category_id STRING,
  brand_id STRING,
  etl_date DATE,
  etl_create_time TIMESTAMP,
  dw_batch_id STRING
)
USING delta
PARTITIONED BY (`date`)
LOCATION  'dbfs:/mnt/${spark.dbr_env}/data_warehouse/media_stg.db/tb_emedia_jd_jst_daily_search_mapping_fail';