%sql
-- tmall_ztc_keyword_cumul
DROP TABLE IF EXISTS `dws`.`tb_emedia_tmall_ztc_keyword_cumul__mapping_success`;
CREATE TABLE IF NOT EXISTS `dws`.`tb_emedia_tmall_ztc_keyword_cumul__mapping_success` (
    thedate String,
    impression String,
    click String,
    cost String,
    ctr String,
    cpc String,
    cpm String,
    fav_total String,
    fav_item_total String,
    fav_shop_total String,
    cart_total String,
    direct_cart_total String,
    indirect_cart_total String,
    cart_total_cost String,
    fav_item_total_cost String,
    fav_item_total_coverage String,
    cart_total_coverage String,
    epre_pay_amt String,
    epre_pay_cnt String,
    dir_epre_pay_amt String,
    dir_epre_pay_cnt String,
    indir_epre_pay_amt String,
    indir_epre_pay_cnt String,
    transaction_total String,
    direct_transaction String,
    indirect_transaction String,
    transaction_shipping_total String,
    direct_transaction_shipping String,
    indirect_transaction_shipping String,
    roi String,
    coverage String,
    direct_transaction_shipping_coverage String,
    click_shopping_num String,
    click_shopping_amt String,
    search_impression String,
    search_transaction String,
    ww_cnt String,
    hfh_dj_cnt String,
    hfh_dj_amt String,
    hfh_ys_cnt String,
    hfh_ys_amt String,
    hfh_ykj_cnt String,
    hfh_ykj_amt String,
    rh_cnt String,
    lz_cnt String,
    transaction_total_in_yuan String,
    cpm_in_yuan String,
    indir_epre_pay_amt_in_yuan String,
    cpc_in_yuan String,
    dir_epre_pay_amt_in_yuan String,
    click_shopping_amt_in_yuan String,
    campaign_type String,
    hfh_ys_amt_in_yuan String,
    campaign_id String,
    cart_total_cost_in_yuan String,
    direct_transaction_in_yuan String,
    indirect_transaction_in_yuan String,
    campaign_title String,
    fav_item_total_cost_in_yuan String,
    epre_pay_amt_in_yuan String,
    hfh_ykj_amt_in_yuan String,
    cost_in_yuan String,
    search_transaction_in_yuan String,
    campaign_type_name String,
    adgroup_title String,
    adgroup_id String,
    item_id String,
    linkurl String,
    img_url String,
    hfh_dj_amt_in_yuan String,
    wireless_price String,
    avg_rank String,
    pc_price String,
    bidword_str String,
    campaign_budget String,
    bidword_id String,
    req_start_time String,
    req_end_time String,
    req_offset String,
    req_page_size String,
    req_effect String,
    req_effect_days String,
    req_storeId String,
    req_pv_type_in String,
    dw_resource String,
    dw_create_time String,
    dw_batch_number String,
    data_source String,
    dw_etl_date String,
    dw_batch_id String,
    category_id STRING,
    brand_id STRING,
    `etl_date` DATE,
    `etl_create_time` TIMESTAMP
)
USING delta
PARTITIONED BY (`thedate`)
LOCATION  'dbfs:/mnt/qa/data_warehouse/media_dws.db/tb_emedia_tmall_ztc_keyword_cumul__mapping_success';


DROP TABLE IF EXISTS `stg`.`tb_emedia_tmall_ztc_keyword_cumul__mapping_fail`;
CREATE TABLE IF NOT EXISTS `stg`.`tb_emedia_tmall_ztc_keyword_cumul__mapping_fail` (
    thedate String,
    impression String,
    click String,
    cost String,
    ctr String,
    cpc String,
    cpm String,
    fav_total String,
    fav_item_total String,
    fav_shop_total String,
    cart_total String,
    direct_cart_total String,
    indirect_cart_total String,
    cart_total_cost String,
    fav_item_total_cost String,
    fav_item_total_coverage String,
    cart_total_coverage String,
    epre_pay_amt String,
    epre_pay_cnt String,
    dir_epre_pay_amt String,
    dir_epre_pay_cnt String,
    indir_epre_pay_amt String,
    indir_epre_pay_cnt String,
    transaction_total String,
    direct_transaction String,
    indirect_transaction String,
    transaction_shipping_total String,
    direct_transaction_shipping String,
    indirect_transaction_shipping String,
    roi String,
    coverage String,
    direct_transaction_shipping_coverage String,
    click_shopping_num String,
    click_shopping_amt String,
    search_impression String,
    search_transaction String,
    ww_cnt String,
    hfh_dj_cnt String,
    hfh_dj_amt String,
    hfh_ys_cnt String,
    hfh_ys_amt String,
    hfh_ykj_cnt String,
    hfh_ykj_amt String,
    rh_cnt String,
    lz_cnt String,
    transaction_total_in_yuan String,
    cpm_in_yuan String,
    indir_epre_pay_amt_in_yuan String,
    cpc_in_yuan String,
    dir_epre_pay_amt_in_yuan String,
    click_shopping_amt_in_yuan String,
    campaign_type String,
    hfh_ys_amt_in_yuan String,
    campaign_id String,
    cart_total_cost_in_yuan String,
    direct_transaction_in_yuan String,
    indirect_transaction_in_yuan String,
    campaign_title String,
    fav_item_total_cost_in_yuan String,
    epre_pay_amt_in_yuan String,
    hfh_ykj_amt_in_yuan String,
    cost_in_yuan String,
    search_transaction_in_yuan String,
    campaign_type_name String,
    adgroup_title String,
    adgroup_id String,
    item_id String,
    linkurl String,
    img_url String,
    hfh_dj_amt_in_yuan String,
    wireless_price String,
    avg_rank String,
    pc_price String,
    bidword_str String,
    campaign_budget String,
    bidword_id String,
    req_start_time String,
    req_end_time String,
    req_offset String,
    req_page_size String,
    req_effect String,
    req_effect_days String,
    req_storeId String,
    req_pv_type_in String,
    dw_resource String,
    dw_create_time String,
    dw_batch_number String,
    data_source String,
    dw_etl_date String,
    dw_batch_id String,
    category_id STRING,
    brand_id STRING,
    `etl_date` DATE,
    `etl_create_time` TIMESTAMP
)
USING delta
PARTITIONED BY (`thedate`)
LOCATION  'dbfs:/mnt/qa/data_warehouse/media_stg.db/tb_emedia_tmall_ztc_keyword_cumul__mapping_fail';
