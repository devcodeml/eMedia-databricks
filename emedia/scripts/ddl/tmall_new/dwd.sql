
DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_ylmf_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_ylmf_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `sub_crowd_name` STRING,
  `audience_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `cost` DECIMAL(20,4),
  `click` BIGINT,
  `impression` BIGINT,
  `order_quantity` BIGINT,
  `order_amount` DECIMAL(20,4),
  `cart_quantity` BIGINT,
  `gmv_order_quantity` BIGINT,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_ylmf_daily_fact';

DROP TABLE IF EXISTS `dwd`.`ylmf_adzone_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_adzone_daily_mapping_success` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `adzone_id` STRING,
  `adzone_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpm` STRING,
  `ctr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `search_click_cnt` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `campaign_id_list` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_log_date` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_adzone_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`ylmf_adzone_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_adzone_daily_mapping_fail` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `adzone_id` STRING,
  `adzone_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpm` STRING,
  `ctr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `search_click_cnt` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `campaign_id_list` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_log_date` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_adzone_daily_mapping_fail';


DROP TABLE IF EXISTS `dwd`.`ylmf_adzone_daily`;
CREATE TABLE `dwd`.`ylmf_adzone_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `adzone_id` STRING,
  `adzone_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpm` STRING,
  `ctr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `search_click_cnt` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `campaign_id_list` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_log_date` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_adzone_daily';

DROP TABLE IF EXISTS `dwd`.`feedflow_adzone_daily`;
CREATE TABLE `dwd`.`feedflow_adzone_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `adzone_id` STRING,
  `adzone_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpm` STRING,
  `ctr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `search_click_cnt` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `campaign_id_list` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_log_date` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/feedflow_adzone_daily';

DROP TABLE IF EXISTS `dwd`.`super_zz_adzone_daily`;
CREATE TABLE `dwd`.`super_zz_adzone_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `adzone_id` STRING,
  `adzone_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpm` STRING,
  `ctr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `search_click_cnt` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `campaign_id_list` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_log_date` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/super_zz_adzone_daily';

DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_campaign_daily_mapping_success` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_campaign_daily_mapping_fail` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_daily`;
CREATE TABLE `dwd`.`ylmf_campaign_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_daily';

DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_group_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_campaign_group_daily_mapping_success` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_group_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_group_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_campaign_group_daily_mapping_fail` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_group_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`ylmf_campaign_group_daily`;
CREATE TABLE `dwd`.`ylmf_campaign_group_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_campaign_group_daily';

DROP TABLE IF EXISTS `dwd`.`super_zz_campaign_daily`;
CREATE TABLE `dwd`.`super_zz_campaign_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/super_zz_campaign_daily';

DROP TABLE IF EXISTS `dwd`.`ylmf_creative_package_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_creative_package_daily_mapping_success` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `creative_package_id` STRING,
  `creative_package_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_creative_package_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`ylmf_creative_package_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_creative_package_daily_mapping_fail` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `creative_package_id` STRING,
  `creative_package_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_creative_package_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`ylmf_creative_package_daily`;
CREATE TABLE `dwd`.`ylmf_creative_package_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `creative_package_id` STRING,
  `creative_package_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_creative_package_daily';

DROP TABLE IF EXISTS `dwd`.`super_zz_creative_daily`;
CREATE TABLE `dwd`.`super_zz_creative_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `creative_package_id` STRING,
  `creative_package_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/super_zz_creative_daily';

DROP TABLE IF EXISTS `dwd`.`feedflow_creative_daily`;
CREATE TABLE `dwd`.`feedflow_creative_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `creative_package_id` STRING,
  `creative_package_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/feedflow_creative_daily';

DROP TABLE IF EXISTS `dwd`.`zz_creative_daily`;
CREATE TABLE `dwd`.`zz_creative_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `creative_package_id` STRING,
  `creative_package_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/zz_creative_daily';

DROP TABLE IF EXISTS `dwd`.`ylmf_creative_package_daily_old`;
CREATE TABLE `dwd`.`ylmf_creative_package_daily_old` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `creative_package_id` STRING,
  `creative_package_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_creative_package_daily_old';

DROP TABLE IF EXISTS `dwd`.`ylmf_crowd_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_crowd_daily_mapping_success` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `sub_crowd_value` STRING,
  `target_name` STRING,
  `target_type` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_crowd_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`ylmf_crowd_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_crowd_daily_mapping_fail` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `sub_crowd_value` STRING,
  `target_name` STRING,
  `target_type` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_crowd_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`ylmf_crowd_daily`;
CREATE TABLE `dwd`.`ylmf_crowd_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `sub_crowd_value` STRING,
  `target_name` STRING,
  `target_type` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_crowd_daily';

DROP TABLE IF EXISTS `dwd`.`feedflow_crowd_daily`;
CREATE TABLE `dwd`.`feedflow_crowd_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `sub_crowd_value` STRING,
  `target_name` STRING,
  `target_type` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/feedflow_crowd_daily';

DROP TABLE IF EXISTS `dwd`.`super_zz_crowd_daily`;
CREATE TABLE `dwd`.`super_zz_crowd_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `sub_crowd_value` STRING,
  `target_name` STRING,
  `target_type` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/super_zz_crowd_daily';

DROP TABLE IF EXISTS `dwd`.`zz_target_daily`;
CREATE TABLE `dwd`.`zz_target_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `sub_crowd_value` STRING,
  `target_name` STRING,
  `target_type` STRING,
  `add_new_charge` STRING,
  `add_new_uv` STRING,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` STRING,
  `alipay_inshop_amt` DECIMAL(20,4),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` STRING,
  `avg_deep_access_times` STRING,
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` STRING,
  `cpm` STRING,
  `ctr` STRING,
  `cvr` STRING,
  `deep_inshop_pv` STRING,
  `dir_shop_col_num` STRING,
  `gmv_inshop_amt` STRING,
  `gmv_inshop_num` BIGINT,
  `icvr` STRING,
  `impression` BIGINT,
  `inshop_item_col_num` STRING,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` STRING,
  `inshop_pv_rate` STRING,
  `inshop_uv` STRING,
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` STRING,
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_promotion_entity_id` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/zz_target_daily';

DROP TABLE IF EXISTS `dwd`.`ylmf_promotion_daily_mapping_success`;
CREATE TABLE `dwd`.`ylmf_promotion_daily_mapping_success` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,8),
  `add_new_uv` BIGINT,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` DECIMAL(20,10),
  `alipay_inshop_amt` DECIMAL(20,10),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` BIGINT,
  `avg_deep_access_times` DECIMAL(20,10),
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` DECIMAL(20,10),
  `cpm` DECIMAL(20,10),
  `ctr` STRING,
  `cvr` DECIMAL(20,10),
  `deep_inshop_pv` DECIMAL(20,4),
  `dir_shop_col_num` BIGINT,
  `gmv_inshop_amt` DECIMAL(20,8),
  `gmv_inshop_num` BIGINT,
  `icvr` DECIMAL(20,10),
  `impression` BIGINT,
  `inshop_item_col_num` BIGINT,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` BIGINT,
  `inshop_pv_rate` STRING,
  `inshop_uv` DECIMAL(20,4),
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` DECIMAL(20,10),
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_promotion_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`ylmf_promotion_daily_mapping_fail`;
CREATE TABLE `dwd`.`ylmf_promotion_daily_mapping_fail` (
  `ad_date` DATE,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,8),
  `add_new_uv` BIGINT,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` DECIMAL(20,10),
  `alipay_inshop_amt` DECIMAL(20,10),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` BIGINT,
  `avg_deep_access_times` DECIMAL(20,10),
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` DECIMAL(20,10),
  `cpm` DECIMAL(20,10),
  `ctr` STRING,
  `cvr` DECIMAL(20,10),
  `deep_inshop_pv` DECIMAL(20,4),
  `dir_shop_col_num` BIGINT,
  `gmv_inshop_amt` DECIMAL(20,8),
  `gmv_inshop_num` BIGINT,
  `icvr` DECIMAL(20,10),
  `impression` BIGINT,
  `inshop_item_col_num` BIGINT,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` BIGINT,
  `inshop_pv_rate` STRING,
  `inshop_uv` DECIMAL(20,4),
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` DECIMAL(20,10),
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `category_id` STRING,
  `brand_id` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_promotion_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`ylmf_promotion_daily`;
CREATE TABLE `dwd`.`ylmf_promotion_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,8),
  `add_new_uv` BIGINT,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` DECIMAL(20,10),
  `alipay_inshop_amt` DECIMAL(20,10),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` BIGINT,
  `avg_deep_access_times` DECIMAL(20,10),
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` DECIMAL(20,10),
  `cpm` DECIMAL(20,10),
  `ctr` STRING,
  `cvr` DECIMAL(20,10),
  `deep_inshop_pv` DECIMAL(20,4),
  `dir_shop_col_num` BIGINT,
  `gmv_inshop_amt` DECIMAL(20,8),
  `gmv_inshop_num` BIGINT,
  `icvr` DECIMAL(20,10),
  `impression` BIGINT,
  `inshop_item_col_num` BIGINT,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` BIGINT,
  `inshop_pv_rate` STRING,
  `inshop_uv` DECIMAL(20,4),
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` DECIMAL(20,10),
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ylmf_promotion_daily';

DROP TABLE IF EXISTS `dwd`.`super_zz_adgroup_daily`;
CREATE TABLE `dwd`.`super_zz_adgroup_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,8),
  `add_new_uv` BIGINT,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` DECIMAL(20,10),
  `alipay_inshop_amt` DECIMAL(20,10),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` BIGINT,
  `avg_deep_access_times` DECIMAL(20,10),
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` DECIMAL(20,10),
  `cpm` DECIMAL(20,10),
  `ctr` STRING,
  `cvr` DECIMAL(20,10),
  `deep_inshop_pv` DECIMAL(20,4),
  `dir_shop_col_num` BIGINT,
  `gmv_inshop_amt` DECIMAL(20,8),
  `gmv_inshop_num` BIGINT,
  `icvr` DECIMAL(20,10),
  `impression` BIGINT,
  `inshop_item_col_num` BIGINT,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` BIGINT,
  `inshop_pv_rate` STRING,
  `inshop_uv` DECIMAL(20,4),
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` DECIMAL(20,10),
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/super_zz_adgroup_daily';

DROP TABLE IF EXISTS `dwd`.`feedflow_adgroup_daily`;
CREATE TABLE `dwd`.`feedflow_adgroup_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,8),
  `add_new_uv` BIGINT,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` DECIMAL(20,10),
  `alipay_inshop_amt` DECIMAL(20,10),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` BIGINT,
  `avg_deep_access_times` DECIMAL(20,10),
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` DECIMAL(20,10),
  `cpm` DECIMAL(20,10),
  `ctr` STRING,
  `cvr` DECIMAL(20,10),
  `deep_inshop_pv` DECIMAL(20,4),
  `dir_shop_col_num` BIGINT,
  `gmv_inshop_amt` DECIMAL(20,8),
  `gmv_inshop_num` BIGINT,
  `icvr` DECIMAL(20,10),
  `impression` BIGINT,
  `inshop_item_col_num` BIGINT,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` BIGINT,
  `inshop_pv_rate` STRING,
  `inshop_uv` DECIMAL(20,4),
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` DECIMAL(20,10),
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/feedflow_adgroup_daily';

DROP TABLE IF EXISTS `dwd`.`zz_adgroup_daily`;
CREATE TABLE `dwd`.`zz_adgroup_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `req_storeId` STRING,
  `effect_type` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `campaign_group_id` STRING,
  `campaign_group_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `promotion_entity_id` STRING,
  `promotion_entity_name` STRING,
  `add_new_charge` DECIMAL(20,8),
  `add_new_uv` BIGINT,
  `add_new_uv_cost` STRING,
  `add_new_uv_rate` DECIMAL(20,10),
  `alipay_inshop_amt` DECIMAL(20,10),
  `alipay_inshop_num` BIGINT,
  `avg_access_page_num` BIGINT,
  `avg_deep_access_times` DECIMAL(20,10),
  `cart_num` BIGINT,
  `charge` DECIMAL(20,4),
  `click` BIGINT,
  `cpc` DECIMAL(20,10),
  `cpm` DECIMAL(20,10),
  `ctr` STRING,
  `cvr` DECIMAL(20,10),
  `deep_inshop_pv` DECIMAL(20,4),
  `dir_shop_col_num` BIGINT,
  `gmv_inshop_amt` DECIMAL(20,8),
  `gmv_inshop_num` BIGINT,
  `icvr` DECIMAL(20,10),
  `impression` BIGINT,
  `inshop_item_col_num` BIGINT,
  `inshop_potential_uv` STRING,
  `inshop_potential_uv_rate` STRING,
  `inshop_pv` BIGINT,
  `inshop_pv_rate` STRING,
  `inshop_uv` DECIMAL(20,4),
  `prepay_inshop_amt` STRING,
  `prepay_inshop_num` STRING,
  `return_pv` STRING,
  `return_pv_cost` STRING,
  `roi` DECIMAL(20,10),
  `search_click_cnt` STRING,
  `search_click_cost` STRING,
  `biz_code` STRING,
  `offset` STRING,
  `page_size` STRING,
  `query_time_dim` STRING,
  `query_domain` STRING,
  `group_by_campaign_id` STRING,
  `group_by_log_date` STRING,
  `start_time` STRING,
  `end_time` STRING,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/zz_adgroup_daily';

DROP TABLE IF EXISTS `dwd`.`tmsha_effect_daily_mapping_success`;
CREATE TABLE `dwd`.`tmsha_effect_daily_mapping_success` (
  `position_name` STRING,
  `ali_brand_name` STRING,
  `alipay_uv` BIGINT,
  `alipay_num` BIGINT,
  `alipay_fee` DECIMAL(20,4),
  `ad_date` DATE,
  `effect` STRING,
  `req_group_by_adzone` BOOLEAN,
  `req_group_by_brand` BOOLEAN,
  `req_storeId` INT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `effect_days` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tmsha_effect_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`tmsha_effect_daily_mapping_fail`;
CREATE TABLE `dwd`.`tmsha_effect_daily_mapping_fail` (
  `position_name` STRING,
  `ali_brand_name` STRING,
  `alipay_uv` BIGINT,
  `alipay_num` BIGINT,
  `alipay_fee` DECIMAL(20,4),
  `ad_date` DATE,
  `effect` STRING,
  `req_group_by_adzone` BOOLEAN,
  `req_group_by_brand` BOOLEAN,
  `req_storeId` INT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `effect_days` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tmsha_effect_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`tmsha_effect_daily`;
CREATE TABLE `dwd`.`tmsha_effect_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `position_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `ali_brand_name` STRING,
  `click_pv` BIGINT,
  `click_uv` BIGINT,
  `alipay_uv` BIGINT,
  `alipay_num` BIGINT,
  `alipay_fee` DECIMAL(20,4),
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `req_storeId` INT,
  `req_group_by_adzone` BOOLEAN,
  `req_group_by_brand` BOOLEAN,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tmsha_effect_daily';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_tmsha_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_tmsha_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `position_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `ali_brand_name` STRING,
  `click_pv` BIGINT,
  `click_uv` BIGINT,
  `alipay_uv` BIGINT,
  `alipay_num` BIGINT,
  `alipay_fee` DECIMAL(20,4),
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_tmsha_daily_fact';

DROP TABLE IF EXISTS `dwd`.`tmsha_report_daily`;
CREATE TABLE `dwd`.`tmsha_report_daily` (
  `position_name` STRING,
  `click_uv` BIGINT,
  `click_pv` BIGINT,
  `ad_date` DATE,
  `req_group_by_adzone` BOOLEAN,
  `req_storeId` INT,
  `dw_resource` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP,
  `ad_format_lv2` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `ali_brand_name` STRING,
  `alipay_uv` BIGINT,
  `alipay_num` BIGINT,
  `alipay_fee` DECIMAL(20,4),
  `dw_source` STRING)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tmsha_report_daily';

DROP TABLE IF EXISTS `dwd`.`mxdp_adgroup_daily_mapping_success`;
CREATE TABLE `dwd`.`mxdp_adgroup_daily_mapping_success` (
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `total_cart_quantity` BIGINT,
  `clicks` BIGINT,
  `click_cvr` DOUBLE,
  `click_roi` DECIMAL(19,4),
  `click_transactionshipping` INT,
  `click_transactiontotal` DOUBLE,
  `click_uv` BIGINT,
  `cost` DECIMAL(19,4),
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `ctr` DOUBLE,
  `cvr` DOUBLE,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `impressions` BIGINT,
  `roi` DOUBLE,
  `ad_date` DATE,
  `transaction_shipping_total` DECIMAL(19,4),
  `transaction_total` DECIMAL(19,4),
  `uv` BIGINT,
  `uv_new` BIGINT,
  `req_traffic_type` STRING,
  `req_start_date` STRING,
  `req_end_date` STRING,
  `effect` STRING,
  `store_id` STRING,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `effect_days` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/mxdp_adgroup_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`mxdp_adgroup_daily_mapping_fail`;
CREATE TABLE `dwd`.`mxdp_adgroup_daily_mapping_fail` (
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `total_cart_quantity` BIGINT,
  `clicks` BIGINT,
  `click_cvr` DOUBLE,
  `click_roi` DECIMAL(19,4),
  `click_transactionshipping` INT,
  `click_transactiontotal` DOUBLE,
  `click_uv` BIGINT,
  `cost` DECIMAL(19,4),
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `ctr` DOUBLE,
  `cvr` DOUBLE,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `impressions` BIGINT,
  `roi` DOUBLE,
  `ad_date` DATE,
  `transaction_shipping_total` DECIMAL(19,4),
  `transaction_total` DECIMAL(19,4),
  `uv` BIGINT,
  `uv_new` BIGINT,
  `req_traffic_type` STRING,
  `req_start_date` STRING,
  `req_end_date` STRING,
  `effect` STRING,
  `store_id` STRING,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `effect_days` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/mxdp_adgroup_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`mxdp_adgroup_daily`;
CREATE TABLE `dwd`.`mxdp_adgroup_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `req_traffic_type` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `impressions` BIGINT,
  `clicks` BIGINT,
  `cost` DECIMAL(19,4),
  `favorite_item_quantity` BIGINT,
  `transaction_shipping_total` DECIMAL(19,4),
  `favorite_shop_quantity` BIGINT,
  `total_cart_quantity` BIGINT,
  `transaction_total` DECIMAL(19,4),
  `order_quantity` INT,
  `order_value` DECIMAL(19,4),
  `click_roi` DECIMAL(19,4),
  `click_uv` BIGINT,
  `uv` BIGINT,
  `uv_new` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `click_cvr` DOUBLE,
  `click_transactionshipping` INT,
  `click_transactiontotal` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `ctr` DOUBLE,
  `cvr` DOUBLE,
  `roi` DOUBLE,
  `req_start_date` STRING,
  `req_end_date` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/mxdp_adgroup_daily';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_mxdp_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_mxdp_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `req_traffic_type` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `impression` BIGINT,
  `click` BIGINT,
  `cost` DECIMAL(19,4),
  `favorite_item_quantity` BIGINT,
  `transaction_shipping_total` DECIMAL(19,4),
  `favorite_shop_quantity` BIGINT,
  `total_cart_quantity` BIGINT,
  `transaction_total` DECIMAL(19,4),
  `order_quantity` INT,
  `order_value` DECIMAL(19,4),
  `click_roi` DECIMAL(19,4),
  `click_uv` BIGINT,
  `uv` BIGINT,
  `uv_new` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_mxdp_daily_fact';

DROP TABLE IF EXISTS `dwd`.`pptx_adgroup_daily_mapping_success`;
CREATE TABLE `dwd`.`pptx_adgroup_daily_mapping_success` (
  `clicks` BIGINT,
  `click_uv` BIGINT,
  `ctr` DECIMAL(19,4),
  `impressions` BIGINT,
  `solution_id` INT,
  `solution_name` STRING,
  `target_name` STRING,
  `task_id` INT,
  `task_name` STRING,
  `ad_date` DATE,
  `uv` BIGINT,
  `uv_ctr` DECIMAL(19,4),
  `req_start_date` STRING,
  `req_end_date` STRING,
  `store_id` STRING,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/pptx_adgroup_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`pptx_adgroup_daily_mapping_fail`;
CREATE TABLE `dwd`.`pptx_adgroup_daily_mapping_fail` (
  `clicks` BIGINT,
  `click_uv` BIGINT,
  `ctr` DECIMAL(19,4),
  `impressions` BIGINT,
  `solution_id` INT,
  `solution_name` STRING,
  `target_name` STRING,
  `task_id` INT,
  `task_name` STRING,
  `ad_date` DATE,
  `uv` BIGINT,
  `uv_ctr` DECIMAL(19,4),
  `req_start_date` STRING,
  `req_end_date` STRING,
  `store_id` STRING,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/pptx_adgroup_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`pptx_adgroup_daily`;
CREATE TABLE `dwd`.`pptx_adgroup_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `target_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `impressions` BIGINT,
  `clicks` BIGINT,
  `ctr` DECIMAL(19,4),
  `click_uv` BIGINT,
  `uv` BIGINT,
  `uv_ctr` DECIMAL(19,4),
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `solution_id` INT,
  `solution_name` STRING,
  `task_id` INT,
  `task_name` STRING,
  `req_start_date` STRING,
  `req_end_date` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/pptx_adgroup_daily';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_pptx_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_pptx_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `target_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `impression` BIGINT,
  `click` BIGINT,
  `ctr` DECIMAL(19,4),
  `click_uv` BIGINT,
  `uv` BIGINT,
  `uv_ctr` DECIMAL(19,4),
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_pptx_daily_fact';

DROP TABLE IF EXISTS `dwd`.`ppzq_adgroup_daily_mapping_success`;
CREATE TABLE `dwd`.`ppzq_adgroup_daily_mapping_success` (
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `total_cart_quantity` BIGINT,
  `clicks` BIGINT,
  `click_cvr` DOUBLE,
  `click_roi` DECIMAL(19,4),
  `click_transactiontotal` DOUBLE,
  `cost` DECIMAL(19,4),
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `ctr` DOUBLE,
  `cvr` DOUBLE,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `impressions` BIGINT,
  `roi` DOUBLE,
  `ad_date` DATE,
  `transaction_shipping_total` DECIMAL(19,4),
  `transaction_total` DECIMAL(19,4),
  `uv` BIGINT,
  `uv_new` BIGINT,
  `traffic_type` STRING,
  `req_start_date` STRING,
  `req_end_date` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ppzq_adgroup_daily_mapping_success';

DROP TABLE IF EXISTS `dwd`.`ppzq_adgroup_daily_mapping_fail`;
CREATE TABLE `dwd`.`ppzq_adgroup_daily_mapping_fail` (
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `total_cart_quantity` BIGINT,
  `clicks` BIGINT,
  `click_cvr` DOUBLE,
  `click_roi` DECIMAL(19,4),
  `click_transactiontotal` DOUBLE,
  `cost` DECIMAL(19,4),
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `ctr` DOUBLE,
  `cvr` DOUBLE,
  `favorite_item_quantity` BIGINT,
  `favorite_shop_quantity` BIGINT,
  `impressions` BIGINT,
  `roi` DOUBLE,
  `ad_date` DATE,
  `transaction_shipping_total` DECIMAL(19,4),
  `transaction_total` DECIMAL(19,4),
  `uv` BIGINT,
  `uv_new` BIGINT,
  `traffic_type` STRING,
  `req_start_date` STRING,
  `req_end_date` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `store_id` STRING,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `category_id` STRING,
  `brand_id` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ppzq_adgroup_daily_mapping_fail';

DROP TABLE IF EXISTS `dwd`.`ppzq_adgroup_daily`;
CREATE TABLE `dwd`.`ppzq_adgroup_daily` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `traffic_type` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `impressions` BIGINT,
  `clicks` BIGINT,
  `cost` DECIMAL(19,4),
  `favorite_item_quantity` BIGINT,
  `transaction_shipping_total` DECIMAL(19,4),
  `favorite_shop_quantity` BIGINT,
  `total_cart_quantity` BIGINT,
  `transaction_total` DECIMAL(19,4),
  `order_quantity` INT,
  `order_value` DECIMAL(19,4),
  `click_roi` DECIMAL(19,4),
  `click_uv` BIGINT,
  `uv` BIGINT,
  `uv_new` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `click_cvr` DOUBLE,
  `click_transactiontotal` DOUBLE,
  `cpc` DOUBLE,
  `cpm` DOUBLE,
  `ctr` DOUBLE,
  `cvr` DOUBLE,
  `roi` DOUBLE,
  `req_start_date` STRING,
  `req_end_date` STRING,
  `etl_source_table` STRING,
  `etl_date` DATE,
  `etl_create_time` TIMESTAMP)
USING delta
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/ppzq_adgroup_daily';

DROP TABLE IF EXISTS `dwd`.`tb_media_emedia_ppzq_daily_fact`;
CREATE TABLE `dwd`.`tb_media_emedia_ppzq_daily_fact` (
  `ad_date` DATE,
  `ad_format_lv2` STRING,
  `store_id` STRING,
  `effect` STRING,
  `effect_days` STRING,
  `traffic_type` STRING,
  `campaign_id` STRING,
  `campaign_name` STRING,
  `adgroup_id` STRING,
  `adgroup_name` STRING,
  `report_level` STRING,
  `report_level_id` STRING,
  `report_level_name` STRING,
  `emedia_category_id` STRING,
  `emedia_brand_id` STRING,
  `mdm_category_id` STRING,
  `mdm_brand_id` STRING,
  `mdm_productline_id` STRING,
  `impression` BIGINT,
  `click` BIGINT,
  `cost` DECIMAL(19,4),
  `favorite_item_quantity` BIGINT,
  `transaction_shipping_total` DECIMAL(19,4),
  `favorite_shop_quantity` BIGINT,
  `total_cart_quantity` BIGINT,
  `transaction_total` DECIMAL(19,4),
  `order_quantity` INT,
  `order_value` DECIMAL(19,4),
  `click_roi` DECIMAL(19,4),
  `click_uv` BIGINT,
  `uv` BIGINT,
  `uv_new` BIGINT,
  `dw_source` STRING,
  `dw_create_time` STRING,
  `dw_batch_number` STRING,
  `etl_source_table` STRING,
  `etl_create_time` TIMESTAMP,
  `etl_update_time` TIMESTAMP)
USING delta
PARTITIONED BY (report_level)
LOCATION  'dbfs:/mnt/prod/data_warehouse/media_dwd.db/tb_media_emedia_ppzq_daily_fact';
